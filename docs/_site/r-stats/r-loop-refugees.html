<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  

  <title>Looping example in R - Data reporting @ Cronkite</title>
  <link rel="stylesheet" href="http://localhost:4000/cronkite-docs/assets/css/just-the-docs.css">

  

  
  <script type="text/javascript" src="http://localhost:4000/cronkite-docs/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Looping example in R | Data reporting @ Cronkite</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Looping example in R" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism" />
<meta property="og:description" content="A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism" />
<link rel="canonical" href="http://localhost:4000/cronkite-docs/r-stats/r-loop-refugees.html" />
<meta property="og:url" content="http://localhost:4000/cronkite-docs/r-stats/r-loop-refugees.html" />
<meta property="og:site_name" content="Data reporting @ Cronkite" />
<script type="application/ld+json">
{"url":"http://localhost:4000/cronkite-docs/r-stats/r-loop-refugees.html","description":"A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism","headline":"Looping example in R","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="http://localhost:4000/cronkite-docs" class="site-title fs-6 lh-tight">Data reporting @ Cronkite</a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list">
    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
        
      
    
      
    
      
    
      
    
      
        
      
    
      
    
      
    
      
    
      
    
      
        
      
    
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/cronkite-docs/" class="navigation-list-link">Home</a>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/cronkite-docs/general" class="navigation-list-link">General resources</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/general/story-list.html" class="navigation-list-link">Story list</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/general/sourcing.html" class="navigation-list-link">Data sources and sourcing</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/general/newsroom-math.html" class="navigation-list-link">Newsroom math</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/general/file-formats.html" class="navigation-list-link">File formats</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/general/programming-concepts.html" class="navigation-list-link">Intro to coding</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/general/data-diary.html" class="navigation-list-link">Replication and the data diary</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/cronkite-docs/excel" class="navigation-list-link">Excel</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/excel/xlguides" class="navigation-list-link">Excel guides</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-refresher.html" class="navigation-list-link">Excel refresher</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-tidydata.html" class="navigation-list-link">Data types / tidy data</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-filtersort.html" class="navigation-list-link">Filter and sort</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-formulas.html" class="navigation-list-link">Excel formulas</a>
                              </li>
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-pivot.html" class="navigation-list-link">Grouping with pivot tables</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/excel/xlpractice" class="navigation-list-link">Excel practice</a>
                      
                        
                        <ul class="navigation-list-child-list">
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/practice/01-excel-azpop-exercise.html" class="navigation-list-link">Change and percent in Arizona population data</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/practice/03-excel-rates.html" class="navigation-list-link">Rates and ratios with FBI data</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/practice/05-excel-police-uof.html" class="navigation-list-link">Build your own use of force database</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/practice/07-excel-kpop.html" class="navigation-list-link">Formulas for boring Spotify playlists</a>
                              </li>
                            
                          
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/practice/08-excel-pop-filter-sort.html" class="navigation-list-link">Population data filter & sort</a>
                              </li>
                            
                          
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/practice/11-excel-pivot-pools.html" class="navigation-list-link">Practice with swimming pool inspections</a>
                              </li>
                            
                          
                            
                              <li class="navigation-list-item ">
                                <a href="http://localhost:4000/cronkite-docs/excel/practice/12-excel-baseball.html" class="navigation-list-link">Pivot tables with baseball scores</a>
                              </li>
                            
                          
                            
                          
                            
                          
                        </ul>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/cronkite-docs/r-stats" class="navigation-list-link">R for journalism</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/r-stats/r-intro.html" class="navigation-list-link">Starting R</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/cronkite-docs/special" class="navigation-list-link">Special</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/special/scrape-part1.html" class="navigation-list-link">Scraping part 1</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/special/cleanup_pdf.html" class="navigation-list-link">PDF tools</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/special/regex-beginning.html" class="navigation-list-link">Intro to Regular Expressions</a>
                      
                    </li>
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/special/cleanup_openrefine.html" class="navigation-list-link">Cleaning data with OpenRefine</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/cronkite-docs/records" class="navigation-list-link">Public records</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/foia/foia-help.html" class="navigation-list-link">Getting FOIA help</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/foia/public-records-outside-in.html" class="navigation-list-link">Public records strategy</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/foia/arizona-foia.html" class="navigation-list-link">Arizona public records</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/foia/tips.html" class="navigation-list-link">FOIA resources</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/cronkite-docs/workshops" class="navigation-list-link">Workshops</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/workshops/newstrain/newstrain.html" class="navigation-list-link">NewsTrain Phoenix</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/workshops/bootcamp.html" class="navigation-list-link">Cronkite bootcamp</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/workshops/cronkite-mayo.html" class="navigation-list-link">Cronkite-Mayo</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/workshops/writing.html" class="navigation-list-link">NICAR master class</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/workshops/phd-sources.html" class="navigation-list-link">Links to source data for doctoral students</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/cronkite-docs/workshops/fundamental1day.html" class="navigation-list-link">1-day CAR workshop</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
  </ul>
</nav>

      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-000 mb-0">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          
            <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
              
                <li class="d-inline-block my-0"><a href="https://isearch.asu.edu/profile/3189494">Sarah Cohen / Knight Chair / Cronkite School</a></li>
              
            </ul>
          
        </div>
      </div>
      <div class="main-content">
        
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                  <li class="breadcrumb-nav-list-item"><a href="">R for Journalism</a></li>
                
                <li class="breadcrumb-nav-list-item"><span>Looping example in R</span></li>
              </ol>
            </nav>
          
        
        <div id="main-content" class="page-content" role="main">
          <h1 id="loop-through-sheets-in-a-workbook">Loop through sheets in a workbook</h1>

<h2 id="step-1-read-the-full-workbook">Step 1: Read the full workbook</h2>

<p>I’ve opened this in Excel, and seen that it has sheets named after the years, with the first one a “cumulative” sheet that we don’t need. The first step is to read all of the sheets in, and get their names. In my computer, the Excel file is in a sub-folder under my working directory called “data”</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## ── Attaching packages ────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──

## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.6
## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0

## ── Conflicts ───────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span><span class="w">

</span><span class="c1">#this creates a list of names of sheets.</span><span class="w">
</span><span class="n">sheets</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">excel_sheets</span><span class="p">(</span><span class="s2">"Refugee+Admissions+Report+FY2019_10_31.xls"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
          </span><span class="n">set_names</span><span class="p">()</span><span class="w">

</span><span class="c1"># get rid of the first  sheet of cumulative totals.</span><span class="w">
</span><span class="n">sheets</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sheets</span><span class="p">[</span><span class="m">-1</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>Create a shell into which we can pour the answer for countries and for regions.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_country</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">(),</span><span class="w">
                          </span><span class="n">country</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">(),</span><span class="w">
                          </span><span class="n">admitted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">integer</span><span class="p">(),</span><span class="w">
                          </span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">(),</span><span class="w">
                          </span><span class="n">fiscal_year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">(),</span><span class="w">
                          </span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">df_region</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">(),</span><span class="w">
                         </span><span class="n">ceiling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">integer</span><span class="p">(),</span><span class="w">
                         </span><span class="n">admitted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">integer</span><span class="p">(),</span><span class="w">
                         </span><span class="n">fiscal_year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">(),</span><span class="w">
                         </span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="w">
                      </span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="try-one-year-in-all-one-step">Try one year in all one step.</h3>

<p>A trick:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  rowSums (is.na (tmp_df))
</code></pre></div></div>

<p>uses a trick that TRUE is the same thing as the number one. So if there are 16 columns, a row sum of is.na(row) is the number of cells that have na in them.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#read in the name of the file, the range that could possibly have values, with a sheet called '2017'. In my computer, it's in a sub-folder called "data"</span><span class="w">
</span><span class="n">tmp_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Refugee+Admissions+Report+FY2019_10_31.xls"</span><span class="p">,</span><span class="w"> </span><span class="n">range</span><span class="o">=</span><span class="s2">"A8:P105"</span><span class="p">,</span><span class="w"> </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"2017"</span><span class="p">)</span><span class="w">

</span><span class="c1">#change the field names.</span><span class="w">
</span><span class="n">colnames</span><span class="w"> </span><span class="p">(</span><span class="n">tmp_df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"region"</span><span class="p">,</span><span class="w"> </span><span class="s2">"country"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ceiling"</span><span class="p">,</span><span class="w"> </span><span class="s2">"admitted"</span><span class="p">,</span><span class="w"> </span><span class="s2">"oct"</span><span class="p">,</span><span class="w"> </span><span class="s2">"nov"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dec"</span><span class="p">,</span><span class="w"> </span><span class="s2">"jan"</span><span class="p">,</span><span class="w"> </span><span class="s2">"feb"</span><span class="p">,</span><span class="w"> </span><span class="s2">"mar"</span><span class="p">,</span><span class="w"> </span><span class="s2">"apr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"may"</span><span class="p">,</span><span class="w"> </span><span class="s2">"jun"</span><span class="p">,</span><span class="w"> </span><span class="s2">"jul"</span><span class="p">,</span><span class="w"> </span><span class="s2">"aug"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sep"</span><span class="p">)</span><span class="w">

</span><span class="c1">#this says, add up the number of columns with NA in them, and if it's not the same as the number of columns, keep it. In other words, eliminate the ones that are entirely NA</span><span class="w">
</span><span class="n">tmp_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tmp_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
          </span><span class="c1">#fill in the fiscal_year</span><span class="w">
          </span><span class="n">mutate</span><span class="w"> </span><span class="p">(</span><span class="s2">"fiscal_year"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"2017"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
          </span><span class="c1">#how many empty cells are in each row?</span><span class="w">
          </span><span class="n">mutate</span><span class="w"> </span><span class="p">(</span><span class="s2">"empty_col_ct"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rowSums</span><span class="w"> </span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">tmp_df</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
          </span><span class="c1">#keep only those that have fewer than 15 of the 16 empty cells. These are the extras.</span><span class="w">
          </span><span class="n">filter</span><span class="w"> </span><span class="p">(</span><span class="n">empty_col_ct</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
          </span><span class="c1">#fill in the missing regions that we want to keep</span><span class="w">
          </span><span class="n">fill</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
          </span><span class="c1">#get rid of the ones that don't have a country. My problem in class was that I had it in quotes.</span><span class="w">
          </span><span class="n">filter</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">is.na</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
          </span><span class="c1">#and flip the months into a column</span><span class="w">
          </span><span class="n">gather</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">"month"</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">=</span><span class="s2">"admitted"</span><span class="p">,</span><span class="w"> </span><span class="s2">"oct"</span><span class="o">:</span><span class="s2">"sep"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
          </span><span class="c1">#just keeep the fields I want in the order I want</span><span class="w">
          </span><span class="n">select</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="p">,</span><span class="w"> </span><span class="n">admitted</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">fiscal_year</span><span class="p">)</span><span class="w">

</span><span class="c1">#we now have a narrow, tall dataset with the right variables in the right order.</span><span class="w">

</span><span class="c1">#attach it to the master dataset</span><span class="w">
</span><span class="n">df_country</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">df_country</span><span class="p">,</span><span class="w"> </span><span class="n">tmp_df</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 id="try-it-in-a-loop">Try it in a loop.</h2>

<p>We now have the whole thing done in one step. All we have to do is loop through the names of the sheets, and then repeat it using that name to fill in the fiscal year. If you didn’t have that, you might need something else to identify the years – there might be some cell in the worksheet you can pick up or something else.</p>

<p>I re-ran the creation chunk above to set the df_country to 0 observations.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#let's make sure the data frame we want to use is empty -- it has no rows.</span><span class="w">
</span><span class="n">df_country</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_country</span><span class="p">[</span><span class="m">0</span><span class="p">,]</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sheets</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1">#I'm actually not sure if I understand what kind of object the sheets is, so this is just making sure it's a character field , which we'll use as fiscal year</span><span class="w">
  </span><span class="n">this_year</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w">
  </span><span class="c1">#read in the name of the file, the range that could possibly have values, with a sheet that changes each time, based on the current value of this_year</span><span class="w">
  </span><span class="n">tmp_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Refugee+Admissions+Report+FY2019_10_31.xls"</span><span class="p">,</span><span class="w"> </span><span class="n">range</span><span class="o">=</span><span class="s2">"A8:P105"</span><span class="p">,</span><span class="w"> </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this_year</span><span class="p">)</span><span class="w">

  </span><span class="c1">#change the field names.</span><span class="w">
  </span><span class="n">colnames</span><span class="w"> </span><span class="p">(</span><span class="n">tmp_df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"region"</span><span class="p">,</span><span class="w"> </span><span class="s2">"country"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ceiling"</span><span class="p">,</span><span class="w"> </span><span class="s2">"admitted"</span><span class="p">,</span><span class="w"> </span><span class="s2">"oct"</span><span class="p">,</span><span class="w"> </span><span class="s2">"nov"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dec"</span><span class="p">,</span><span class="w"> </span><span class="s2">"jan"</span><span class="p">,</span><span class="w"> </span><span class="s2">"feb"</span><span class="p">,</span><span class="w"> </span><span class="s2">"mar"</span><span class="p">,</span><span class="w"> </span><span class="s2">"apr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"may"</span><span class="p">,</span><span class="w"> </span><span class="s2">"jun"</span><span class="p">,</span><span class="w"> </span><span class="s2">"jul"</span><span class="p">,</span><span class="w"> </span><span class="s2">"aug"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sep"</span><span class="p">)</span><span class="w">

  </span><span class="n">tmp_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tmp_df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1">#fill in the fiscal_year</span><span class="w">
    </span><span class="n">mutate</span><span class="w"> </span><span class="p">(</span><span class="s2">"fiscal_year"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this_year</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1">#how many empty cells are in each row?</span><span class="w">
    </span><span class="n">mutate</span><span class="w"> </span><span class="p">(</span><span class="s2">"empty_col_ct"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rowSums</span><span class="w"> </span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">tmp_df</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1">#keep only those that have fewer than 15 of the 16 empty cells. These are the extras.</span><span class="w">
    </span><span class="n">filter</span><span class="w"> </span><span class="p">(</span><span class="n">empty_col_ct</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1">#fill in the missing regions that we want to keep</span><span class="w">
    </span><span class="n">fill</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1">#get rid of the ones that don't have a country. My problem in class was that I had it in quotes.</span><span class="w">
    </span><span class="n">filter</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">is.na</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1">#and flip the months into a column</span><span class="w">
    </span><span class="n">gather</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">"month"</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">=</span><span class="s2">"admitted"</span><span class="p">,</span><span class="w"> </span><span class="s2">"oct"</span><span class="o">:</span><span class="s2">"sep"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1">#just keeep the fields I want in the order I want</span><span class="w">
    </span><span class="n">select</span><span class="w"> </span><span class="p">(</span><span class="n">region</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="p">,</span><span class="w"> </span><span class="n">admitted</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">fiscal_year</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="c1">#I realized we had a mistake, with the totals included. Let's get rid of them</span><span class="w">
    </span><span class="n">filter</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">str_detect</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">,</span><span class="w"> </span><span class="s2">"Total"</span><span class="p">))</span><span class="w">

  </span><span class="c1">#we now have a narrow, tall dataset with the right variables in the right order.</span><span class="w">

  </span><span class="c1">#attach it to the master dataset</span><span class="w">
  </span><span class="n">df_country</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">df_country</span><span class="p">,</span><span class="w"> </span><span class="n">tmp_df</span><span class="p">)</span><span class="w">

  </span><span class="c1">#Now go on to the next sheet, unless there aren't anymore.</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Voila! You now have df_country, with 15,036 observations and 5 variables. Let’s check it to make sure it worked properly. (If you got more, make sure you re-created the data set from two steps up)</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">annual_totals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
</span><span class="n">df_country</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">,</span><span class="w"> </span><span class="n">fiscal_year</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="w"> </span><span class="p">(</span><span class="n">total_admitted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">admitted</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="w"> </span><span class="p">(</span><span class="n">country</span><span class="p">,</span><span class="w"> </span><span class="n">fiscal_year</span><span class="p">)</span><span class="w">

</span><span class="c1">#Lets look at the top few country-years."</span><span class="w">
</span><span class="n">annual_totals</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="w"> </span><span class="p">(</span><span class="n">desc</span><span class="w"> </span><span class="p">(</span><span class="n">total_admitted</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">head</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["fiscal_year"],"name":[2],"type":["chr"],"align":["left"]},{"label":["total_admitted"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Iraq","2":"2014","3":"19769"},{"1":"Iraq","2":"2013","3":"19488"},{"1":"Iraq","2":"2009","3":"18838"},{"1":"Burma","2":"2015","3":"18386"},{"1":"Burma","2":"2009","3":"18202"},{"1":"Burma","2":"2008","3":"18139"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#and say you wanted to see it with the years across the top and the countries down the side?</span><span class="w">
</span><span class="n">annual_totals</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">spread</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">fiscal_year</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_admitted</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="m">0</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["2001"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["2002"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["2003"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["2004"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["2005"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["2006"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["2007"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["2008"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["2009"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["2010"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["2011"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["2012"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["2013"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["2014"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["2015"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["2016"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["2017"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["2018"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["2019"],"name":[20],"type":["dbl"],"align":["right"]}],"data":[{"1":"Afghanistan","2":"2930","3":"1683","4":"1453","5":"959","6":"902","7":"651","8":"441","9":"576","10":"349","11":"515","12":"428","13":"481","14":"661","15":"753","16":"910","17":"2737","18":"1311","19":"805","20":"34"},{"1":"Albania","2":"3","3":"5","4":"2","5":"2","6":"0","7":"1","8":"0","9":"0","10":"2","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Algeria","2":"31","3":"0","4":"4","5":"1","6":"1","7":"1","8":"0","9":"0","10":"0","11":"2","12":"0","13":"0","14":"0","15":"2","16":"0","17":"0","18":"0","19":"2","20":"0"},{"1":"Angola","2":"34","3":"16","4":"21","5":"20","6":"21","7":"13","8":"4","9":"0","10":"8","11":"0","12":"2","13":"0","14":"6","15":"0","16":"5","17":"3","18":"0","19":"1","20":"0"},{"1":"Argentina","2":"5","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Armenia","2":"26","3":"30","4":"63","5":"88","6":"86","7":"87","8":"29","9":"9","10":"4","11":"1","12":"15","13":"8","14":"3","15":"10","16":"49","17":"55","18":"57","19":"58","20":"0"},{"1":"Azerbaijan","2":"450","3":"114","4":"406","5":"407","6":"299","7":"77","8":"78","9":"30","10":"38","11":"18","12":"16","13":"10","14":"3","15":"15","16":"18","17":"32","18":"20","19":"2","20":"0"},{"1":"Bahrain","2":"3","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Bangladesh","2":"0","3":"0","4":"1","5":"0","6":"0","7":"2","8":"0","9":"0","10":"0","11":"2","12":"0","13":"0","14":"1","15":"2","16":"3","17":"1","18":"7","19":"2","20":"1"},{"1":"Belarus","2":"984","3":"680","4":"702","5":"659","6":"445","7":"350","8":"219","9":"111","10":"146","11":"103","12":"66","13":"83","14":"10","15":"46","16":"98","17":"185","18":"73","19":"181","20":"11"},{"1":"Belgium","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"2","18":"0","19":"0","20":"0"},{"1":"Benin","2":"0","3":"1","4":"2","5":"0","6":"0","7":"0","8":"1","9":"0","10":"0","11":"1","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Bhutan","2":"0","3":"0","4":"0","5":"0","6":"0","7":"3","8":"0","9":"5320","10":"13452","11":"12363","12":"14999","13":"15070","14":"9134","15":"8434","16":"5775","17":"5817","18":"3550","19":"2228","20":"0"},{"1":"Bosnia and Herzegovina","2":"13827","3":"3481","4":"506","5":"244","6":"61","7":"16","8":"2","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Botswana","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"1","19":"0","20":"0"},{"1":"Bulgaria","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"1","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Burkina Faso (UVolta)","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"6","9":"0","10":"0","11":"1","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"2","19":"0","20":"0"},{"1":"Burma","2":"544","3":"128","4":"203","5":"1056","6":"1447","7":"1612","8":"13896","9":"18139","10":"18202","11":"16693","12":"16972","13":"14160","14":"16299","15":"14598","16":"18386","17":"12347","18":"5078","19":"3555","20":"304"},{"1":"Burundi","2":"109","3":"62","4":"16","5":"276","6":"214","7":"466","8":"4545","9":"2889","10":"762","11":"530","12":"110","13":"186","14":"193","15":"68","16":"1186","17":"694","18":"291","19":"201","20":"7"},{"1":"Cambodia","2":"23","3":"4","4":"7","5":"3","6":"9","7":"9","8":"15","9":"8","10":"15","11":"9","12":"5","13":"6","14":"30","15":"44","16":"0","17":"18","18":"3","19":"0","20":"0"},{"1":"Cameroon","2":"5","3":"6","4":"6","5":"1","6":"6","7":"29","8":"5","9":"2","10":"4","11":"6","12":"0","13":"7","14":"0","15":"5","16":"8","17":"14","18":"21","19":"15","20":"2"},{"1":"Canada","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"1","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Central African Republic","2":"1","3":"0","4":"1","5":"24","6":"0","7":"23","8":"15","9":"56","10":"59","11":"45","12":"182","13":"136","14":"318","15":"25","16":"270","17":"401","18":"275","19":"148","20":"0"},{"1":"Chad","2":"7","3":"1","4":"1","5":"4","6":"0","7":"4","8":"10","9":"23","10":"6","11":"28","12":"25","13":"12","14":"32","15":"21","16":"16","17":"2","18":"7","19":"1","20":"0"},{"1":"China","2":"15","3":"9","4":"9","5":"3","6":"13","7":"21","8":"27","9":"43","10":"54","11":"72","12":"28","13":"45","14":"86","15":"53","16":"30","17":"57","18":"24","19":"6","20":"0"},{"1":"Colombia","2":"0","3":"8","4":"149","5":"577","6":"323","7":"115","8":"54","9":"94","10":"57","11":"123","12":"46","13":"126","14":"230","15":"252","16":"521","17":"529","18":"233","19":"128","20":"0"},{"1":"Congo","2":"10","3":"5","4":"41","5":"73","6":"43","7":"66","8":"206","9":"197","10":"293","11":"154","12":"27","13":"102","14":"161","15":"30","16":"52","17":"16","18":"5","19":"5","20":"2"},{"1":"Costa Rica","2":"0","3":"0","4":"0","5":"1","6":"0","7":"2","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Croatia","2":"104","3":"109","4":"144","5":"92","6":"39","7":"1","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"3","18":"0","19":"0","20":"0"},{"1":"Cuba","2":"2946","3":"1919","4":"306","5":"2980","6":"6360","7":"3143","8":"2922","9":"4177","10":"4800","11":"4818","12":"2920","13":"1948","14":"4205","15":"4062","16":"1527","17":"354","18":"177","19":"0","20":"0"},{"1":"Dem. Rep. Congo","2":"264","3":"107","4":"251","5":"569","6":"424","7":"405","8":"848","9":"727","10":"1135","11":"3174","12":"977","13":"1863","14":"2563","15":"4540","16":"7876","17":"16370","18":"9377","19":"7878","20":"612"},{"1":"Djibouti","2":"12","3":"1","4":"1","5":"6","6":"0","7":"0","8":"0","9":"0","10":"3","11":"0","12":"0","13":"0","14":"0","15":"0","16":"2","17":"0","18":"4","19":"1","20":"0"},{"1":"Ecuador","2":"0","3":"0","4":"0","5":"2","6":"8","7":"0","8":"0","9":"3","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"1","17":"0","18":"0","19":"0","20":"0"},{"1":"Egypt","2":"24","3":"0","4":"0","5":"3","6":"0","7":"2","8":"3","9":"5","10":"7","11":"15","12":"6","13":"13","14":"3","15":"21","16":"13","17":"21","18":"9","19":"1","20":"0"},{"1":"El Salvador","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"364","18":"1124","19":"725","20":"23"},{"1":"Equatorial Guinea","2":"0","3":"0","4":"3","5":"0","6":"25","7":"11","8":"14","9":"0","10":"9","11":"9","12":"0","13":"0","14":"0","15":"0","16":"2","17":"0","18":"0","19":"0","20":"0"},{"1":"Eritrea","2":"114","3":"13","4":"23","5":"128","6":"327","7":"538","8":"963","9":"251","10":"1571","11":"2570","12":"2032","13":"1346","14":"1824","15":"1488","16":"1596","17":"1949","18":"1917","19":"1269","20":"358"},{"1":"Estonia","2":"58","3":"38","4":"28","5":"27","6":"17","7":"7","8":"6","9":"6","10":"2","11":"0","12":"0","13":"1","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Ethiopia","2":"1457","3":"330","4":"1702","5":"2689","6":"1663","7":"1271","8":"1028","9":"299","10":"321","11":"668","12":"560","13":"620","14":"765","15":"728","16":"626","17":"1131","18":"766","19":"376","20":"39"},{"1":"France","2":"0","3":"0","4":"1","5":"0","6":"0","7":"0","8":"1","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Gabon","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"1","11":"2","12":"3","13":"1","14":"0","15":"1","16":"0","17":"2","18":"0","19":"0","20":"0"},{"1":"Gambia","2":"5","3":"0","4":"9","5":"3","6":"0","7":"6","8":"13","9":"6","10":"10","11":"10","12":"7","13":"2","14":"11","15":"1","16":"3","17":"0","18":"5","19":"0","20":"0"},{"1":"Gaza Strip","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"7","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Georgia","2":"51","3":"14","4":"53","5":"33","6":"11","7":"4","8":"7","9":"20","10":"4","11":"4","12":"20","13":"7","14":"1","15":"13","16":"9","17":"16","18":"0","19":"1","20":"0"},{"1":"Germany","2":"0","3":"0","4":"0","5":"0","6":"1","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Ghana","2":"4","3":"4","4":"8","5":"1","6":"1","7":"7","8":"4","9":"0","10":"1","11":"0","12":"1","13":"0","14":"0","15":"0","16":"0","17":"0","18":"3","19":"2","20":"0"},{"1":"Greece","2":"2","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Guatemala","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"5","13":"0","14":"0","15":"0","16":"0","17":"8","18":"50","19":"42","20":"3"},{"1":"Guinea","2":"0","3":"5","4":"2","5":"0","6":"0","7":"0","8":"1","9":"3","10":"3","11":"9","12":"1","13":"0","14":"9","15":"9","16":"3","17":"5","18":"5","19":"10","20":"0"},{"1":"Guinea - Bissau","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"2","10":"0","11":"0","12":"4","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Haiti","2":"24","3":"7","4":"0","5":"17","6":"8","7":"0","8":"0","9":"0","10":"0","11":"18","12":"0","13":"0","14":"0","15":"4","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Honduras","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"20","12":"5","13":"0","14":"0","15":"0","16":"0","17":"84","18":"104","19":"59","20":"2"},{"1":"India","2":"0","3":"0","4":"0","5":"1","6":"1","7":"0","8":"0","9":"0","10":"0","11":"0","12":"5","13":"2","14":"3","15":"7","16":"1","17":"4","18":"2","19":"1","20":"0"},{"1":"Indonesia","2":"4","3":"18","4":"17","5":"5","6":"6","7":"10","8":"0","9":"0","10":"0","11":"0","12":"1","13":"0","14":"0","15":"1","16":"3","17":"7","18":"2","19":"0","20":"0"},{"1":"Iran","2":"6461","3":"1535","4":"2471","5":"1786","6":"1856","7":"2792","8":"5482","9":"5270","10":"5381","11":"3543","12":"2032","13":"1758","14":"2578","15":"2846","16":"3109","17":"3750","18":"2577","19":"41","20":"1"},{"1":"Iraq","2":"2465","3":"466","4":"298","5":"66","6":"198","7":"202","8":"1608","9":"13822","10":"18838","11":"18016","12":"9388","13":"12163","14":"19488","15":"19769","16":"12676","17":"9880","18":"6886","19":"140","20":"6"},{"1":"Israel","2":"0","3":"0","4":"2","5":"1","6":"2","7":"0","8":"1","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"1"},{"1":"Ivory Coast","2":"1","3":"3","4":"4","5":"0","6":"5","7":"23","8":"11","9":"30","10":"9","11":"4","12":"7","13":"33","14":"20","15":"42","16":"28","17":"79","18":"51","19":"14","20":"0"},{"1":"Jamaica","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"1","17":"1","18":"0","19":"1","20":"0"},{"1":"Jordan","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"3","9":"0","10":"0","11":"7","12":"3","13":"3","14":"13","15":"7","16":"2","17":"6","18":"5","19":"1","20":"0"},{"1":"Kazakhstan","2":"290","3":"223","4":"116","5":"312","6":"80","7":"124","8":"45","9":"62","10":"52","11":"46","12":"53","13":"7","14":"11","15":"24","16":"58","17":"91","18":"39","19":"47","20":"0"},{"1":"Kenya","2":"6","3":"24","4":"3","5":"0","6":"1","7":"5","8":"0","9":"0","10":"1","11":"0","12":"1","13":"23","14":"5","15":"21","16":"3","17":"6","18":"6","19":"3","20":"5"},{"1":"Korea, North","2":"0","3":"0","4":"0","5":"0","6":"0","7":"9","8":"22","9":"37","10":"25","11":"8","12":"23","13":"22","14":"17","15":"8","16":"15","17":"14","18":"12","19":"5","20":"0"},{"1":"Kuwait","2":"0","3":"6","4":"0","5":"14","6":"0","7":"0","8":"24","9":"1","10":"7","11":"40","12":"5","13":"3","14":"12","15":"12","16":"4","17":"2","18":"6","19":"1","20":"0"},{"1":"Kyrgyzstan","2":"116","3":"69","4":"46","5":"100","6":"38","7":"15","8":"17","9":"25","10":"46","11":"27","12":"30","13":"49","14":"19","15":"8","16":"17","17":"40","18":"25","19":"12","20":"0"},{"1":"Laos","2":"23","3":"18","4":"13","5":"6005","6":"8517","7":"830","8":"117","9":"59","10":"14","11":"36","12":"211","13":"21","14":"0","15":"0","16":"0","17":"7","18":"0","19":"0","20":"0"},{"1":"Latvia","2":"133","3":"57","4":"49","5":"52","6":"25","7":"21","8":"17","9":"6","10":"2","11":"0","12":"4","13":"0","14":"0","15":"0","16":"0","17":"0","18":"8","19":"0","20":"0"},{"1":"Lebanon","2":"5","3":"7","4":"2","5":"2","6":"0","7":"0","8":"0","9":"2","10":"1","11":"2","12":"2","13":"0","14":"0","15":"1","16":"3","17":"0","18":"0","19":"0","20":"0"},{"1":"Liberia","2":"3442","3":"560","4":"2956","5":"7140","6":"4289","7":"2346","8":"1606","9":"992","10":"385","11":"244","12":"121","13":"69","14":"94","15":"31","16":"12","17":"16","18":"8","19":"6","20":"0"},{"1":"Libya","2":"5","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"1","12":"1","13":"5","14":"1","15":"0","16":"0","17":"1","18":"3","19":"1","20":"0"},{"1":"Lithuania","2":"44","3":"1","4":"21","5":"13","6":"9","7":"0","8":"4","9":"0","10":"0","11":"4","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Macedonia","2":"2","3":"4","4":"13","5":"0","6":"0","7":"1","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Madagascar (Malagasy Republic)","2":"0","3":"0","4":"0","5":"0","6":"1","7":"0","8":"0","9":"0","10":"3","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Malaysia","2":"5","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"2","12":"4","13":"0","14":"0","15":"0","16":"0","17":"4","18":"0","19":"0","20":"0"},{"1":"Mali","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"2","15":"2","16":"4","17":"6","18":"6","19":"0","20":"0"},{"1":"Mauritania","2":"202","3":"6","4":"0","5":"0","6":"3","7":"88","8":"62","9":"26","10":"16","11":"74","12":"3","13":"0","14":"0","15":"4","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Moldova","2":"1199","3":"1022","4":"616","5":"1711","6":"1016","7":"721","8":"565","9":"487","10":"445","11":"356","12":"331","13":"255","14":"119","15":"142","16":"333","17":"465","18":"301","19":"207","20":"0"},{"1":"Mongolia","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"1","18":"3","19":"0","20":"0"},{"1":"Montenegro","2":"1","3":"0","4":"0","5":"0","6":"2","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Morocco","2":"2","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"3","10":"1","11":"1","12":"0","13":"2","14":"0","15":"0","16":"0","17":"0","18":"2","19":"0","20":"0"},{"1":"Namibia","2":"1","3":"0","4":"0","5":"0","6":"4","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"1","17":"0","18":"0","19":"0","20":"0"},{"1":"Nepal","2":"0","3":"0","4":"0","5":"1","6":"0","7":"1","8":"3","9":"4","10":"7","11":"0","12":"10","13":"47","14":"34","15":"47","16":"26","17":"33","18":"39","19":"12","20":"0"},{"1":"Netherlands","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"1","13":"0","14":"0","15":"0","16":"1","17":"0","18":"0","19":"0","20":"0"},{"1":"New Zealand","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"5","20":"0"},{"1":"Niger","2":"0","3":"0","4":"0","5":"0","6":"0","7":"1","8":"0","9":"0","10":"0","11":"0","12":"0","13":"4","14":"0","15":"0","16":"0","17":"0","18":"0","19":"2","20":"0"},{"1":"Nigeria","2":"85","3":"28","4":"57","5":"34","6":"11","7":"15","8":"20","9":"76","10":"3","11":"2","12":"1","13":"2","14":"2","15":"4","16":"4","17":"7","18":"2","19":"1","20":"0"},{"1":"Norway","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"2","18":"0","19":"0","20":"0"},{"1":"Oman","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"1","19":"0","20":"0"},{"1":"Pakistan","2":"3","3":"0","4":"18","5":"11","6":"9","7":"20","8":"30","9":"104","10":"67","11":"59","12":"54","13":"274","14":"158","15":"240","16":"159","17":"545","18":"346","19":"441","20":"24"},{"1":"Palestine","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"9","10":"65","11":"1053","12":"136","13":"141","14":"164","15":"141","16":"99","17":"50","18":"81","19":"0","20":"0"},{"1":"Philippines","2":"0","3":"0","4":"1","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"1","16":"0","17":"0","18":"2","19":"1","20":"0"},{"1":"Poland","2":"4","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Republic of South Sudan","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"1","14":"17","15":"57","16":"79","17":"189","18":"176","19":"13","20":"0"},{"1":"Reunion","2":"1","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Russia","2":"4596","3":"2105","4":"1396","5":"1446","6":"5982","7":"6003","8":"1773","9":"426","10":"495","11":"326","12":"165","13":"197","14":"125","15":"139","16":"281","17":"462","18":"377","19":"437","20":"0"},{"1":"Rwanda","2":"84","3":"47","4":"47","5":"176","6":"183","7":"112","8":"202","9":"108","10":"111","11":"230","12":"74","13":"157","14":"139","15":"45","16":"173","17":"140","18":"104","19":"110","20":"17"},{"1":"Saudi Arabia","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"1","14":"0","15":"1","16":"3","17":"2","18":"0","19":"1","20":"0"},{"1":"Senegal","2":"4","3":"3","4":"0","5":"0","6":"1","7":"2","8":"0","9":"1","10":"0","11":"2","12":"1","13":"5","14":"2","15":"0","16":"4","17":"16","18":"22","19":"14","20":"0"},{"1":"Serbia","2":"1795","3":"1859","4":"1801","5":"143","6":"38","7":"11","8":"0","9":"1","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"2","19":"0","20":"0"},{"1":"Sierra Leone","2":"1984","3":"176","4":"1378","5":"1084","6":"829","7":"439","8":"166","9":"99","10":"51","11":"54","12":"28","13":"1","14":"4","15":"6","16":"6","17":"3","18":"5","19":"0","20":"0"},{"1":"Slovakia","2":"0","3":"0","4":"1","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Slovenia","2":"2","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Somalia","2":"4946","3":"237","4":"1994","5":"13331","6":"10405","7":"10357","8":"6969","9":"2523","10":"4189","11":"4884","12":"3161","13":"4911","14":"7608","15":"9000","16":"8858","17":"9020","18":"6130","19":"257","20":"3"},{"1":"South Africa","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"1","14":"0","15":"0","16":"2","17":"0","18":"0","19":"1","20":"0"},{"1":"Sri Lanka (Ceylon)","2":"2","3":"5","4":"7","5":"1","6":"0","7":"6","8":"2","9":"1","10":"33","11":"118","12":"69","13":"55","14":"92","15":"57","16":"89","17":"91","18":"12","19":"56","20":"4"},{"1":"Sudan","2":"5944","3":"897","4":"2139","5":"3500","6":"2205","7":"1848","8":"705","9":"375","10":"683","11":"558","12":"334","13":"1077","14":"2160","15":"1315","16":"1578","17":"1458","18":"980","19":"76","20":"5"},{"1":"Sweden","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"1","13":"0","14":"0","15":"0","16":"0","17":"2","18":"1","19":"0","20":"0"},{"1":"Syria","2":"8","3":"4","4":"3","5":"0","6":"7","7":"27","8":"17","9":"24","10":"25","11":"25","12":"29","13":"31","14":"36","15":"105","16":"1682","17":"12587","18":"6557","19":"62","20":"2"},{"1":"Tajikistan","2":"8","3":"4","4":"13","5":"2","6":"6","7":"4","8":"0","9":"2","10":"0","11":"3","12":"0","13":"0","14":"2","15":"0","16":"0","17":"17","18":"0","19":"0","20":"0"},{"1":"Tanzania","2":"1","3":"1","4":"0","5":"0","6":"0","7":"0","8":"0","9":"1","10":"0","11":"0","12":"0","13":"2","14":"0","15":"1","16":"0","17":"1","18":"1","19":"0","20":"0"},{"1":"Thailand","2":"3","3":"4","4":"2","5":"0","6":"0","7":"0","8":"2","9":"0","10":"2","11":"5","12":"4","13":"3","14":"4","15":"0","16":"0","17":"5","18":"4","19":"0","20":"0"},{"1":"Tibet","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"7","10":"0","11":"0","12":"0","13":"9","14":"15","15":"0","16":"0","17":"1","18":"2","19":"0","20":"0"},{"1":"Togo","2":"279","3":"16","4":"47","5":"35","6":"72","7":"18","8":"40","9":"204","10":"14","11":"9","12":"5","13":"26","14":"18","15":"26","16":"1","17":"19","18":"1","19":"0","20":"0"},{"1":"Tunisia","2":"10","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"1","12":"1","13":"1","14":"0","15":"2","16":"7","17":"1","18":"2","19":"0","20":"0"},{"1":"Turkey","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"6","10":"0","11":"3","12":"0","13":"0","14":"0","15":"0","16":"2","17":"0","18":"1","19":"0","20":"0"},{"1":"Turkmenistan","2":"7","3":"1","4":"4","5":"7","6":"1","7":"3","8":"2","9":"2","10":"8","11":"4","12":"2","13":"0","14":"8","15":"2","16":"5","17":"0","18":"0","19":"5","20":"0"},{"1":"Uganda","2":"12","3":"2","4":"1","5":"8","6":"10","7":"20","8":"38","9":"42","10":"8","11":"30","12":"10","13":"18","14":"15","15":"5","16":"67","17":"65","18":"58","19":"42","20":"9"},{"1":"Ukraine","2":"7313","3":"5217","4":"5065","5":"3482","6":"2889","7":"2483","8":"1605","9":"1022","10":"601","11":"449","12":"428","13":"372","14":"227","15":"490","16":"1451","17":"2543","18":"4264","19":"2635","20":"345"},{"1":"Union of Soviet Socialist Republics","2":"10","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"United Arab Emirates","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"1","12":"0","13":"0","14":"0","15":"0","16":"0","17":"1","18":"0","19":"0","20":"0"},{"1":"United Kingdom","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"1","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Uzbekistan","2":"693","3":"394","4":"166","5":"426","6":"271","7":"527","8":"190","9":"134","10":"152","11":"185","12":"96","13":"140","14":"51","15":"69","16":"43","17":"41","18":"35","19":"27","20":"0"},{"1":"Venezuela","2":"0","3":"0","4":"0","5":"0","6":"0","7":"4","8":"0","9":"3","10":"0","11":"3","12":"0","13":"4","14":"3","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Vietnam","2":"3546","3":"3331","4":"1472","5":"1012","6":"2084","7":"3168","8":"1564","9":"1196","10":"1538","11":"891","12":"119","13":"100","14":"86","15":"79","16":"35","17":"58","18":"46","19":"96","20":"14"},{"1":"Yemen","2":"7","3":"0","4":"0","5":"8","6":"0","7":"11","8":"6","9":"0","10":"47","11":"15","12":"0","13":"0","14":"12","15":"3","16":"16","17":"26","18":"21","19":"2","20":"0"},{"1":"Yemen (Sanaa)","2":"0","3":"0","4":"1","5":"0","6":"1","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Yugoslavia","2":"54","3":"1","4":"38","5":"8","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0"},{"1":"Zambia","2":"0","3":"0","4":"1","5":"0","6":"0","7":"0","8":"0","9":"0","10":"1","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"1","18":"1","19":"0","20":"0"},{"1":"Zimbabwe","2":"6","3":"0","4":"0","5":"2","6":"2","7":"13","8":"1","9":"3","10":"10","11":"7","12":"8","13":"3","14":"12","15":"1","16":"7","17":"11","18":"2","19":"13","20":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

<p>Let’s make a searchable, sortable version</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#install.packages("DT")</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span><span class="w">

</span><span class="n">annual_totals</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">spread</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">fiscal_year</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_admitted</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">datatable</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## PhantomJS not found. You can install it with webshot::install_phantomjs(). If it is installed, please make sure the phantomjs executable can be found via the PATH variable.
</code></pre></div></div>

<!--html_preserve-->

<script type="application/json" data-for="htmlwidget-db9656a31db19cdee990">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129"],["Afghanistan","Albania","Algeria","Angola","Argentina","Armenia","Azerbaijan","Bahrain","Bangladesh","Belarus","Belgium","Benin","Bhutan","Bosnia and Herzegovina","Botswana","Bulgaria","Burkina Faso (UVolta)","Burma","Burundi","Cambodia","Cameroon","Canada","Central African Republic","Chad","China","Colombia","Congo","Costa Rica","Croatia","Cuba","Dem. Rep. Congo","Djibouti","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","France","Gabon","Gambia","Gaza Strip","Georgia","Germany","Ghana","Greece","Guatemala","Guinea","Guinea - Bissau","Haiti","Honduras","India","Indonesia","Iran","Iraq","Israel","Ivory Coast","Jamaica","Jordan","Kazakhstan","Kenya","Korea, North","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Liberia","Libya","Lithuania","Macedonia","Madagascar (Malagasy Republic)","Malaysia","Mali","Mauritania","Moldova","Mongolia","Montenegro","Morocco","Namibia","Nepal","Netherlands","New Zealand","Niger","Nigeria","Norway","Oman","Pakistan","Palestine","Philippines","Poland","Republic of South Sudan","Reunion","Russia","Rwanda","Saudi Arabia","Senegal","Serbia","Sierra Leone","Slovakia","Slovenia","Somalia","South Africa","Sri Lanka (Ceylon)","Sudan","Sweden","Syria","Tajikistan","Tanzania","Thailand","Tibet","Togo","Tunisia","Turkey","Turkmenistan","Uganda","Ukraine","Union of Soviet Socialist Republics","United Arab Emirates","United Kingdom","Uzbekistan","Venezuela","Vietnam","Yemen","Yemen (Sanaa)","Yugoslavia","Zambia","Zimbabwe"],[2930,3,31,34,5,26,450,3,0,984,0,0,0,13827,0,0,0,544,109,23,5,0,1,7,15,0,10,0,104,2946,264,12,0,24,0,0,114,58,1457,0,0,5,0,51,0,4,2,0,0,0,24,0,0,4,6461,2465,0,1,0,0,290,6,0,0,116,23,133,5,3442,5,44,2,0,5,0,202,1199,0,1,2,1,0,0,0,0,85,0,0,3,0,0,4,0,1,4596,84,0,4,1795,1984,0,2,4946,0,2,5944,0,8,8,1,3,0,279,10,0,7,12,7313,10,0,0,693,0,3546,7,0,54,0,6],[1683,5,0,16,0,30,114,0,0,680,0,1,0,3481,0,0,0,128,62,4,6,0,0,1,9,8,5,0,109,1919,107,1,0,0,0,0,13,38,330,0,0,0,0,14,0,4,0,0,5,0,7,0,0,18,1535,466,0,3,0,0,223,24,0,6,69,18,57,7,560,0,1,4,0,0,0,6,1022,0,0,0,0,0,0,0,0,28,0,0,0,0,0,0,0,0,2105,47,0,3,1859,176,0,0,237,0,5,897,0,4,4,1,4,0,16,0,0,1,2,5217,0,0,0,394,0,3331,0,0,1,0,0],[1453,2,4,21,0,63,406,0,1,702,0,2,0,506,0,0,0,203,16,7,6,0,1,1,9,149,41,0,144,306,251,1,0,0,0,3,23,28,1702,1,0,9,0,53,0,8,0,0,2,0,0,0,0,17,2471,298,2,4,0,0,116,3,0,0,46,13,49,2,2956,0,21,13,0,0,0,0,616,0,0,0,0,0,0,0,0,57,0,0,18,0,1,0,0,0,1396,47,0,0,1801,1378,1,0,1994,0,7,2139,0,3,13,0,2,0,47,0,0,4,1,5065,0,0,0,166,0,1472,0,1,38,1,0],[959,2,1,20,0,88,407,0,0,659,0,0,0,244,0,0,0,1056,276,3,1,0,24,4,3,577,73,1,92,2980,569,6,2,3,0,0,128,27,2689,0,0,3,0,33,0,1,0,0,0,0,17,0,1,5,1786,66,1,0,0,0,312,0,0,14,100,6005,52,2,7140,0,13,0,0,0,0,0,1711,0,0,0,0,1,0,0,0,34,0,0,11,0,0,0,0,0,1446,176,0,0,143,1084,0,0,13331,0,1,3500,0,0,2,0,0,0,35,0,0,7,8,3482,0,0,0,426,0,1012,8,0,8,0,2],[902,0,1,21,0,86,299,0,0,445,0,0,0,61,0,0,0,1447,214,9,6,0,0,0,13,323,43,0,39,6360,424,0,8,0,0,25,327,17,1663,0,0,0,0,11,1,1,0,0,0,0,8,0,1,6,1856,198,2,5,0,0,80,1,0,0,38,8517,25,0,4289,0,9,0,1,0,0,3,1016,0,2,0,4,0,0,0,0,11,0,0,9,0,0,0,0,0,5982,183,0,1,38,829,0,0,10405,0,0,2205,0,7,6,0,0,0,72,0,0,1,10,2889,0,0,0,271,0,2084,0,1,0,0,2],[651,1,1,13,0,87,77,0,2,350,0,0,3,16,0,0,0,1612,466,9,29,0,23,4,21,115,66,2,1,3143,405,0,0,2,0,11,538,7,1271,0,0,6,0,4,0,7,0,0,0,0,0,0,0,10,2792,202,0,23,0,0,124,5,9,0,15,830,21,0,2346,0,0,1,0,0,0,88,721,0,0,0,0,1,0,0,1,15,0,0,20,0,0,0,0,0,6003,112,0,2,11,439,0,0,10357,0,6,1848,0,27,4,0,0,0,18,0,0,3,20,2483,0,0,0,527,4,3168,11,0,0,0,13],[441,0,0,4,0,29,78,0,0,219,0,1,0,2,0,0,6,13896,4545,15,5,0,15,10,27,54,206,0,0,2922,848,0,0,3,0,14,963,6,1028,1,0,13,0,7,0,4,0,0,1,0,0,0,0,0,5482,1608,1,11,0,3,45,0,22,24,17,117,17,0,1606,0,4,0,0,0,0,62,565,0,0,0,0,3,0,0,0,20,0,0,30,0,0,0,0,0,1773,202,0,0,0,166,0,0,6969,0,2,705,0,17,0,0,2,0,40,0,0,2,38,1605,0,0,0,190,0,1564,6,0,0,0,1],[576,0,0,0,0,9,30,0,0,111,0,0,5320,0,0,0,0,18139,2889,8,2,0,56,23,43,94,197,0,0,4177,727,0,3,5,0,0,251,6,299,0,0,6,0,20,0,0,0,0,3,2,0,0,0,0,5270,13822,0,30,0,0,62,0,37,1,25,59,6,2,992,0,0,0,0,0,0,26,487,0,0,3,0,4,0,0,0,76,0,0,104,9,0,0,0,0,426,108,0,1,1,99,0,0,2523,0,1,375,0,24,2,1,0,7,204,0,6,2,42,1022,0,0,0,134,3,1196,0,0,0,0,3],[349,2,0,8,0,4,38,0,0,146,0,0,13452,0,0,0,0,18202,762,15,4,0,59,6,54,57,293,0,0,4800,1135,3,0,7,0,9,1571,2,321,0,1,10,0,4,0,1,0,0,3,0,0,0,0,0,5381,18838,0,9,0,0,52,1,25,7,46,14,2,1,385,0,0,0,3,0,0,16,445,0,0,1,0,7,0,0,0,3,0,0,67,65,0,0,0,0,495,111,0,0,0,51,0,0,4189,0,33,683,0,25,0,0,2,0,14,0,0,8,8,601,0,0,0,152,0,1538,47,0,0,1,10],[515,0,2,0,0,1,18,0,2,103,0,1,12363,0,0,0,1,16693,530,9,6,0,45,28,72,123,154,0,0,4818,3174,0,0,15,0,9,2570,0,668,0,2,10,0,4,0,0,0,0,9,0,18,20,0,0,3543,18016,0,4,0,7,46,0,8,40,27,36,0,2,244,1,4,0,0,2,0,74,356,0,0,1,0,0,0,0,0,2,0,0,59,1053,0,0,0,0,326,230,0,2,0,54,0,0,4884,0,118,558,0,25,3,0,5,0,9,1,3,4,30,449,0,1,0,185,3,891,15,0,0,0,7],[428,0,0,2,0,15,16,0,0,66,0,0,14999,0,0,0,0,16972,110,5,0,0,182,25,28,46,27,0,0,2920,977,0,0,6,0,0,2032,0,560,0,3,7,0,20,0,1,0,5,1,4,0,5,5,1,2032,9388,0,7,0,3,53,1,23,5,30,211,4,2,121,1,0,0,0,4,0,3,331,0,0,0,0,10,1,0,0,1,0,0,54,136,0,0,0,0,165,74,0,1,0,28,0,0,3161,0,69,334,1,29,0,0,4,0,5,1,0,2,10,428,0,0,0,96,0,119,0,0,0,0,8],[481,0,0,0,0,8,10,0,0,83,0,0,15070,0,0,0,0,14160,186,6,7,0,136,12,45,126,102,0,0,1948,1863,0,0,13,0,0,1346,1,620,0,1,2,7,7,0,0,0,0,0,0,0,0,2,0,1758,12163,0,33,0,3,7,23,22,3,49,21,0,0,69,5,0,0,0,0,0,0,255,0,0,2,0,47,0,0,4,2,0,0,274,141,0,0,1,0,197,157,1,5,0,1,0,0,4911,1,55,1077,0,31,0,2,3,9,26,1,0,0,18,372,0,0,0,140,4,100,0,0,0,0,3],[661,0,0,6,0,3,3,0,1,10,0,0,9134,0,0,1,0,16299,193,30,0,1,318,32,86,230,161,0,0,4205,2563,0,0,3,0,0,1824,0,765,0,0,11,0,1,0,0,0,0,9,0,0,0,3,0,2578,19488,0,20,0,13,11,5,17,12,19,0,0,0,94,1,0,0,0,0,2,0,119,0,0,0,0,34,0,0,0,2,0,0,158,164,0,0,17,0,125,139,0,2,0,4,0,0,7608,0,92,2160,0,36,2,0,4,15,18,0,0,8,15,227,0,0,0,51,3,86,12,0,0,0,12],[753,0,2,0,0,10,15,0,2,46,0,0,8434,0,0,0,0,14598,68,44,5,0,25,21,53,252,30,0,0,4062,4540,0,0,21,0,0,1488,0,728,0,1,1,0,13,0,0,0,0,9,0,4,0,7,1,2846,19769,0,42,0,7,24,21,8,12,8,0,0,1,31,0,0,0,0,0,2,4,142,0,0,0,0,47,0,0,0,4,0,0,240,141,1,0,57,0,139,45,1,0,0,6,0,0,9000,0,57,1315,0,105,0,1,0,0,26,2,0,2,5,490,0,0,1,69,0,79,3,0,0,0,1],[910,0,0,5,0,49,18,0,3,98,0,0,5775,0,0,0,0,18386,1186,0,8,0,270,16,30,521,52,0,0,1527,7876,2,1,13,0,2,1596,0,626,0,0,3,0,9,0,0,0,0,3,0,0,0,1,3,3109,12676,0,28,1,2,58,3,15,4,17,0,0,3,12,0,0,0,0,0,4,0,333,0,0,0,1,26,1,0,0,4,0,0,159,99,0,0,79,0,281,173,3,4,0,6,0,0,8858,2,89,1578,0,1682,0,0,0,0,1,7,2,5,67,1451,0,0,0,43,0,35,16,0,0,0,7],[2737,0,0,3,0,55,32,0,1,185,2,0,5817,0,0,0,0,12347,694,18,14,0,401,2,57,529,16,0,3,354,16370,0,0,21,364,0,1949,0,1131,0,2,0,0,16,0,0,0,8,5,0,0,84,4,7,3750,9880,0,79,1,6,91,6,14,2,40,7,0,0,16,1,0,0,0,4,6,0,465,1,0,0,0,33,0,0,0,7,2,0,545,50,0,0,189,0,462,140,2,16,0,3,0,0,9020,0,91,1458,2,12587,17,1,5,1,19,1,0,0,65,2543,0,1,0,41,0,58,26,0,0,1,11],[1311,0,0,0,0,57,20,0,7,73,0,0,3550,0,1,0,2,5078,291,3,21,0,275,7,24,233,5,0,0,177,9377,4,0,9,1124,0,1917,0,766,0,0,5,0,0,0,3,0,50,5,0,0,104,2,2,2577,6886,0,51,0,5,39,6,12,6,25,0,8,0,8,3,0,0,0,0,6,0,301,3,0,2,0,39,0,0,0,2,0,1,346,81,2,0,176,0,377,104,0,22,2,5,0,0,6130,0,12,980,1,6557,0,1,4,2,1,2,1,0,58,4264,0,0,0,35,0,46,21,0,0,1,2],[805,0,2,1,0,58,2,0,2,181,0,0,2228,0,0,0,0,3555,201,0,15,0,148,1,6,128,5,0,0,0,7878,1,0,1,725,0,1269,0,376,0,0,0,0,1,0,2,0,42,10,0,0,59,1,0,41,140,0,14,1,1,47,3,5,1,12,0,0,0,6,1,0,0,0,0,0,0,207,0,0,0,0,12,0,5,2,1,0,0,441,0,1,0,13,0,437,110,1,14,0,0,0,0,257,1,56,76,0,62,0,0,0,0,0,0,0,5,42,2635,0,0,0,27,0,96,2,0,0,0,13],[34,0,0,0,0,0,0,0,1,11,0,0,0,0,0,0,0,304,7,0,2,0,0,0,0,0,2,0,0,0,612,0,0,0,23,0,358,0,39,0,0,0,0,0,0,0,0,3,0,0,0,2,0,0,1,6,1,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,17,0,0,0,0,0,0,3,0,4,5,0,2,0,0,0,0,0,0,0,0,9,345,0,0,0,0,0,14,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>country<\/th>\n      <th>2001<\/th>\n      <th>2002<\/th>\n      <th>2003<\/th>\n      <th>2004<\/th>\n      <th>2005<\/th>\n      <th>2006<\/th>\n      <th>2007<\/th>\n      <th>2008<\/th>\n      <th>2009<\/th>\n      <th>2010<\/th>\n      <th>2011<\/th>\n      <th>2012<\/th>\n      <th>2013<\/th>\n      <th>2014<\/th>\n      <th>2015<\/th>\n      <th>2016<\/th>\n      <th>2017<\/th>\n      <th>2018<\/th>\n      <th>2019<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

<!--/html_preserve-->



          
        </div>
      </div>
    </div>
  </div>

</body>
</html>

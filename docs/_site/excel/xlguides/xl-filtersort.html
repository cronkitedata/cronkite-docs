<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Filter and sort - Data reporting @ Cronkite</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>Filter and sort | Data reporting @ Cronkite</title> <meta name="generator" content="Jekyll v3.7.4" /> <meta property="og:title" content="Filter and sort" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism" /> <meta property="og:description" content="A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism" /> <link rel="canonical" href="http://localhost:4000/excel/xlguides/xl-filtersort.html" /> <meta property="og:url" content="http://localhost:4000/excel/xlguides/xl-filtersort.html" /> <meta property="og:site_name" content="Data reporting @ Cronkite" /> <script type="application/ld+json"> {"url":"http://localhost:4000/excel/xlguides/xl-filtersort.html","headline":"Filter and sort","description":"A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism","@type":"WebPage","@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight">Data reporting @ Cronkite</a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/" class="navigation-list-link">Home</a></li><li class="navigation-list-item"><a href="http://localhost:4000/general" class="navigation-list-link">General topics</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/general/01-resources.html" class="navigation-list-link">Resources</a></li><li class="navigation-list-item "><a href="http://localhost:4000/general/02-sourcing.html" class="navigation-list-link">Data sources and sourcing</a></li><li class="navigation-list-item "><a href="http://localhost:4000/general/03-newsroom-math.html" class="navigation-list-link">Newsroom math</a></li><li class="navigation-list-item "><a href="http://localhost:4000/general/05-file-formats.html" class="navigation-list-link">File formats</a></li><li class="navigation-list-item "><a href="http://localhost:4000/general/06-programming-concepts.html" class="navigation-list-link">Intro to coding</a></li></ul></li><li class="navigation-list-item active"><a href="http://localhost:4000/excel" class="navigation-list-link">Excel</a><ul class="navigation-list-child-list "><li class="navigation-list-item active"><a href="http://localhost:4000/excel/xlguides" class="navigation-list-link">Excel guides</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-refresher.html" class="navigation-list-link">Excel refresher</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-formulas.html" class="navigation-list-link">Excel formulas</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-tidydata.html" class="navigation-list-link">Data types / tidy data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-pivot.html" class="navigation-list-link">Grouping with pivot tables</a> </li><li class="navigation-list-item active"> <a href="http://localhost:4000/excel/xlguides/xl-filtersort.html" class="navigation-list-link active">Filter and sort</a> </li></ul></li><li class="navigation-list-item "><a href="http://localhost:4000/excel/xlpractice" class="navigation-list-link">Excel practice</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/01-excel-azpop-exercise.html" class="navigation-list-link">Change and percent in Arizona population data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/03-excel-rates.html" class="navigation-list-link">Rates and ratios with FBI data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/05-excel-police-uof.html" class="navigation-list-link">Build your own use of force database</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/07-excel-kpop.html" class="navigation-list-link">Formulas for boring Spotify playlists</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/08-excel-pop-filter-sort.html" class="navigation-list-link">Population data filter & sort</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/11-excel-pivot-pools.html" class="navigation-list-link">Practice with swimming pool inspections</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/12-excel-baseball.html" class="navigation-list-link">Pivot tables with baseball scores</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/r-stats" class="navigation-list-link">R for journalism</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/r-stats/r-intro.html" class="navigation-list-link">Starting R</a></li><li class="navigation-list-item "><a href="http://localhost:4000/r-stats/r-test-embed.html" class="navigation-list-link">Starting R</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/special" class="navigation-list-link">Special</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/special/scrape-part1.html" class="navigation-list-link">Scraping part 1</a></li><li class="navigation-list-item "><a href="http://localhost:4000/special/cleanup_pdf.html" class="navigation-list-link">PDF tools</a></li><li class="navigation-list-item "><a href="http://localhost:4000/special/cleanup_openrefine.html" class="navigation-list-link">Cleaning data with OpenRefine</a></li><li class="navigation-list-item "><a href="http://localhost:4000/special/regex-beginning.html" class="navigation-list-link">Intro to Regular Expressions</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/records" class="navigation-list-link">Public records</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/foia/foia-help.html" class="navigation-list-link">Getting FOIA help</a></li><li class="navigation-list-item "><a href="http://localhost:4000/foia/records-stories.html" class="navigation-list-link">FOIA stories</a></li><li class="navigation-list-item "><a href="http://localhost:4000/foia/public-records-outside-in.html" class="navigation-list-link">Public records strategy</a></li><li class="navigation-list-item "><a href="http://localhost:4000/foia/arizona-foia.html" class="navigation-list-link">Arizona public records</a></li><li class="navigation-list-item "><a href="http://localhost:4000/foia/tips.html" class="navigation-list-link">FOIA resources</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/workshops" class="navigation-list-link">Workshops</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/workshops/bootcamp.html" class="navigation-list-link">Cronkite bootcamp</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/cronkite-mayo.html" class="navigation-list-link">Cronkite-Mayo</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/newstrain/newstrain.html" class="navigation-list-link">NewsTrain Phoenix</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/writing.html" class="navigation-list-link">NICAR master class</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/phd-sources.html" class="navigation-list-link">Links to source data for doctoral students</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/fundamental1day.html" class="navigation-list-link">1-day CAR workshop</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Data reporting @ Cronkite" aria-label="Search Data reporting @ Cronkite" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="https://isearch.asu.edu/profile/3189494">Sarah Cohen / Knight Chair / Cronkite School</a></li> </ul> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/excel">Excel</a></li> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/excel/xlguides">Excel guides</a></li> <li class="breadcrumb-nav-list-item"><span>Filter and sort</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 class="no_toc" id="sorting-and-filtering-to-find-stories"> <a href="#sorting-and-filtering-to-find-stories" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Sorting and filtering to find stories </h1> <ol id="markdown-toc"> <li><a href="#a-sorting-miracle" id="markdown-toc-a-sorting-miracle">A sorting miracle</a></li> <li><a href="#sorting-and-filtering-as-a-reporting-tool" id="markdown-toc-sorting-and-filtering-as-a-reporting-tool">Sorting and filtering as a reporting tool</a> <ol> <li><a href="#create-a-data-table-from-your-spreadsheet" id="markdown-toc-create-a-data-table-from-your-spreadsheet">Create a data table from your spreadsheet</a></li> <li><a href="#sorting" id="markdown-toc-sorting">Sorting</a> <ol> <li><a href="#adding-fields-to-the-sort" id="markdown-toc-adding-fields-to-the-sort">Adding fields to the sort</a></li> </ol> </li> <li><a href="#filtering" id="markdown-toc-filtering">Filtering</a> <ol> <li><a href="#free-text-and-date-filters" id="markdown-toc-free-text-and-date-filters">Free text and date filters</a></li> <li><a href="#creating-your-own-flags-with-filters" id="markdown-toc-creating-your-own-flags-with-filters">Creating your own flags with filters</a></li> </ol> </li> </ol> </li> <li><a href="#faq" id="markdown-toc-faq">FAQ</a> <ol> <li><a href="#how-do-i-turn-off-all-of-my-sort-and-filters" id="markdown-toc-how-do-i-turn-off-all-of-my-sort-and-filters">How do I turn off all of my sort and filters</a></li> <li><a href="#where-is-the-button-to-filter-columns" id="markdown-toc-where-is-the-button-to-filter-columns">Where is the button to filter <em>columns</em>?</a></li> <li><a href="#im-getting-weird-questions-and-alerts-about-sorting" id="markdown-toc-im-getting-weird-questions-and-alerts-about-sorting">I’m getting weird questions and alerts about sorting</a></li> <li><a href="#i-want-to-get-rid-of-my-data-table" id="markdown-toc-i-want-to-get-rid-of-my-data-table">I want to get rid of my data table</a></li> <li><a href="#show-me-a-video" id="markdown-toc-show-me-a-video">Show me a video</a></li> </ol> </li> </ol> <p>Data files used in this tutorial:</p> <ul> <li>Salaries for <a href="/assets/data/xlexamples/phoenix_salaries.xlsx">city workers in Phoenix</a> (source: <a href="https://www.phoenixopendata.com/dataset/staff-salaries">Phoenix Open Data portal</a>)</li> <li><a href="/assets/data/xlexamples/opioidemscalls.xlsx">Opioid-related EMS calls</a> in Tempe, Az. (source and documentation: <a href="https://data.tempe.gov/dataset/opiod-ems-calls">Tempe Open Data Portal</a>)</li> </ul> <h2 id="a-sorting-miracle"> <a href="#a-sorting-miracle" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> A sorting miracle </h2> <p>After Ferguson, Mo., <a href="https://en.wikipedia.org/wiki/Shooting_of_Michael_Brown">police killed Michael Brown in 2014</a>, advocates and journalists began examining the racial and ethnic gap between police departments and the communities they served. The New York Times found a 7-year-old survey conducted by the Justice Department that allowed it to <a href="https://www.nytimes.com/interactive/2014/09/03/us/the-race-gap-in-americas-police-departments.html">compare the data for major cities in a standalone graphic</a> that it published later that year.</p> <p>When newer data reflecting departments’ makeup in 2012 was released a year later, Matt Apuzzo and Sarah Cohen hoped it would show some differences. It didn’t. So they were left trying to find news in the data that was clearly of public interest.</p> <p>After matching up the demographics of police departments with their cities, Cohen started sorting, filtering and Googling. Could there be news in the outliers on the list? Which departments most closely represented their communities? Which ones had unusually large gaps?</p> <p>She quickly stumbled on telling anecdote to frame the story: Inkster, Mich. had one of the least representative departments in the country, and had recently hired a new police chief to help mend the department’s fraught relationship with its largely African-American community. Where had he come from? Selma, Ala., one of the most representative police departments in the nation. Interviews with the chief, William T. Riley III, suggested one reason for some cities’ disparities: there was no state or federal money to pay for training new police officers.</p> <p>“There’s no doubt in my mind we have good police candidates in this city. No doubt,” said Chief Riley, who is African-American. “How hard can it be? You’re telling me everybody here can’t be a police officer?”</p> <p>The story, “<a href="https://www.nytimes.com/2015/11/08/us/politics/police-chiefs-looking-to-diversify-forces-face-structural-hurdles.html">Police Chiefs, Looking to Diversity Forces, Face Structural Hurdles</a>” helped explain the persistent gap between the makeup of police in some areas and the communities they served.</p> <blockquote class="embedly-card"> <h4> <a href="https://nyti.ms/1WENOEM">Police Chiefs, Looking to Diversify Forces, Face Structural Hurdles</a> </h4><p>INKSTER, Mich. - When William T. Riley III became the police chief of this small city west of Detroit this summer, he found a department that bore little resemblance to the city it served. Nearly three-fourths of Inkster's 25,000 residents are black. Its mayor and all six City Council members are, too.</p></blockquote> <script async="" src="//cdn.embedly.com/widgets/platform.js" charset="UTF-8"></script> <h2 id="sorting-and-filtering-as-a-reporting-tool"> <a href="#sorting-and-filtering-as-a-reporting-tool" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Sorting and filtering as a reporting tool </h2> <p>Reporters frequently sort and filter for both stories and for data integrity and cleanup.</p> <p>One of the most common uses of sorting and filtering comes with spreadsheets you build yourself. If you keep your data tidy and make sure that each column has the same <em>type</em> of information – particularly dates – it does’t matter if you’ve had to collect it piecemeal and out of order. Sorting can magically turn it into a chronology, useful for spotting holes in sources’ stories and putting background information in context. If you build fact-checking and sourcing into your spreadsheet, filtering can hide from you any material that isn’t publishable while you’re writing, making it less likely to let poorly sourced or secondary source information into your story.</p> <p>Sorting and filtering can also:</p> <ul> <li>Show you rows containing the highest and lowest values of any column. That can be news or it can be errors or other problems with the data.</li> <li>Let you answer quick “how many?” questions, with a count of the rows that match your criteria.</li> <li>Together, sorting and filtering can narrow your dataset to just the items you want to examine more closely in your reporting.</li> </ul> <h3 id="create-a-data-table-from-your-spreadsheet"> <a href="#create-a-data-table-from-your-spreadsheet" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Create a data table from your spreadsheet </h3> <p>In Excel, you may want to create a “data table” from your spreadsheet to help make sure you’re always sorting and filtering the correct rows. This is a way of enforcing just a little structure and rigor onto a spreadsheet, which usually lets you do whatever you want. There are several benefits to data tables:</p> <ul> <li>Formulas automatically copy throughout your data, whether or not there are empty values next to them.</li> <li>Sorting and filtering are always done on the proper list of rows, once you’re made sure to define the table correctly.</li> <li>You can use column names rather than addresses to reference a field.</li> <li>The column names always stay at the top of your screen, making it unnecessary to freeze panes (which can make navigation more difficult)</li> </ul> <p>It also looks better.</p> <p>Select your entire table, using Shift-CTL-* or by selecting the corners, then choose your table style:</p> <p><img src="/assets/images/06-filtersort-createtable.gif" alt="create table" /></p> <h3 id="sorting"> <a href="#sorting" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Sorting </h3> <p>Sorting means rearranging the rows of a data table into a different order. Some reporters take a conceptual shortcut and call this “sorting columns”. That thinking will only get you into trouble – it lets you forget that you want to keep all of the rows in tact while changing the order in which you see them. In fact, in other languages it’s called “order by” or “arrange” by one or more columns – a much clearer way to think of it.</p> <p>In Excel, look for the sort options under the Data tab at the top of your screen. In this case, sorting from Largest to Smallest gives you the highest-paid employees in the Phoenix city government.</p> <p><img src="/assets/images/06-filtersort-sortdialog.png" alt="sort dialog" /></p> <p>Gives you this:</p> <p><img src="/assets/images/06-filtersort-bysalary.png" alt="sort result" /></p> <h4 id="adding-fields-to-the-sort"> <a href="#adding-fields-to-the-sort" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Adding fields to the sort </h4> <p>You can sort by more than one column to see just the information you want at the top. When you add conditions, Excel sorts by the first column, putting the rows with lowest (or highest) values at the top. When those are the same, it will sort <em>within</em> that group by the second item you mention. And so on.</p> <p>So let’s say I want to see all of the “probable” opioid-related emergency calls in Tempe that were treated with Narcan, ordered chronologically. We’re in luck, because “Yes” comes at the end of the alphabet, letting us sort “From Z to A” to get them on top.</p> <p><img src="/assets/images/06-filtersort-addlevel.png" alt="sort first level" /></p> <p>Add more levels using the + sign in the dialog box:</p> <p><img src="/assets/images/06-filtersort-multilevelsort.png" alt="sort more levels" /></p> <p>Notice that Excel understood that the first two fields were <em>character</em> fields, so it asks you if you want A-&gt;Z or Z-&gt;A (ascending or descending). But when it came to the incident date and time, it understood these were dates, so it asks if you want “Oldest to newest” instead.</p> <p><img src="/assets/images/06-filtersort-sortresult.png" alt="sort result" /></p> <p>(The little arrows on the headers showing you they are sorted only happen when you have your data formatted as a table.)</p> <h3 id="filtering"> <a href="#filtering" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Filtering </h3> <p>Filtering means picking out only some of the rows you want to see based on a criteria you select in a column. Think of it as casting a fishing net – the more filters you add, the fewer fish will be caught.</p> <p>The filtering buttons are shown when you create a data table. If they’re not, look in your Data tab at top press the button that looks like a funnel:</p> <p><img src="/assets/images/06-filtersort-turnonfilter.png" alt="turn on filter" /></p> <p>Looking through your filters is an easy way to see the range of information you have in your dataset. For example, pulling down the button for filtering on the Narcan flag, you see only the options for “Yes” and “No”. But if you click on the dropdown box for the incident date and time, you’ll first see just the years, which you can expand to months, days, and even hours.</p> <p><img src="/assets/images/06-filtersort-twofilters.png" alt="filter dialog" /></p> <p>Check and un-check any of the boxes that you want. Here’s a filter that picks out just the Narcan cases of probable overdoses, sorted chronologically:</p> <p><img src="/assets/images/06-filtersort-filteron.png" alt="filter result" /></p> <p>Excel tells you how many of the rows match your filter – 202 of 650 in this case, shown at the very bottom of the screen. (That count goes away sometimes after a few minutes. Just turn the filter on and off again to see it.) It also gives you several clues that you’re looking at filtered data: The row numbers have turned blue, and and there are dark lines between them when rows are skipped; the drop-down arrows now show a little funnel, indicating that you are using that column for a filter.</p> <h4 id="free-text-and-date-filters"> <a href="#free-text-and-date-filters" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Free text and date filters </h4> <p>The filter box suggests that you can just type your search term to filter for words. It works – sometimes! On any large dataset, it will only filter the first 10,000 choices, which will give you wrong counts if you rely on the number at the bottom of the screen. For that reason, get into the habit of doing it the right way. Use the drop-down menu on the box to choose the word “Contains” (or “Begins with”) and type your words there:</p> <p><img src="/assets/images/06-filtersort-string.png" alt="filter long text" /></p> <p>And when you have numbers or dates, you’ll get different choices. We don’t really have any numbers on this dataset to work with, but here are some choices for dates:</p> <p><img src="/assets/images/06-filtersort-between.png" alt="filter date" /></p> <h4 id="creating-your-own-flags-with-filters"> <a href="#creating-your-own-flags-with-filters" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Creating your own flags with filters </h4> <p>Just from this example, you see why analysts often create some seemingly repetitive information. In this table, there is a list of medications given by the EMS crew, and Narcan might be one of them. To make it easier to analyze, they have also added a “Yes/No” flag just for Narcan, which we used for sorting and filtering.</p> <p>You can create your own flags using filters. (There are other ways to accomplish the same thing using formulas.) I wanted a simple “Yes” / “No” field for oxycodone. Going back to the text filter, we can see that there were 52 rows that contained a mention of Oxycodone in the “current medications” field. When I add a new header to the end, Excel automatically appends it to my data table. I can enter “Yes” into the first row, and copy down, and it will only fill in the visible cells. Remove your filter from the medications list, and it looks like this:</p> <p><img src="/assets/images/06-filtersort-makeflag.png" alt="Flag yes" /></p> <p>Now I can filter for all of the blanks in that field, and fill them in with “No” to create the rest of the flag:</p> <p><img src="/assets/images/06-filtersort-makeflag2.png" alt="Flag yes" /></p> <p>Just be sure you document HOW you made your filter. What did you do with “(Blanks)” or anything that didn’t make sense? You should be able to recreate your flags exactly whenever you make them, and it’s easy to forget exactly what you did.</p> <h2 id="faq"> <a href="#faq" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> FAQ </h2> <h3 id="how-do-i-turn-off-all-of-my-sort-and-filters"> <a href="#how-do-i-turn-off-all-of-my-sort-and-filters" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> How do I turn off all of my sort and filters </h3> <p>In the data tab, chose “Clear” (the funnel with the red “X”) to remove all of the filters and sorts on your table.</p> <h3 id="where-is-the-button-to-filter-columns"> <a href="#where-is-the-button-to-filter-columns" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Where is the button to filter <em>columns</em>? </h3> <p>Sometimes you don’t want to see all of your columns – there are too many and they’re getting confusing. There is no column filter in Excel. (You’ll see how to filter, or “Select”, columns from a dataset in standard programming languages later.)</p> <p>Instead, you can hide the columns you don’t want to see. When columns and rows are hidden, they generally won’t copy to a new sheet.</p> <h3 id="im-getting-weird-questions-and-alerts-about-sorting"> <a href="#im-getting-weird-questions-and-alerts-about-sorting" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> I’m getting weird questions and alerts about sorting </h3> <p><em>Slow down and read the alert</em>. There are two common types of alerts in sorting, since it has the potential to wreck your spreadsheet.</p> <p>The first comes if you selected an entire column, and then just hit the button that says “A-Z” with the arrow. Excel won’t let you do that if it’s formatted as a table, but it will if it’s just a normal spreadsheet. This alert asks you if you REALLY want to sort only the column you’ve selected, separating its meaning from the rest of the rows. The answer is NO. Always. Expand the selection as Excel wants you do to by default.</p> <p><img src="/assets/images/06-filtersort-faq1.png" alt="filter date" /></p> <p>The other comes when you have numbers that are treated as text. This is a tricky question, and a properly tidied spreadsheet should avoid it most of the time. If you have the same type of data in each column, the answer to this question shouldn’t matter. If not, neither one will give you what you want.</p> <h3 id="i-want-to-get-rid-of-my-data-table"> <a href="#i-want-to-get-rid-of-my-data-table" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> I want to get rid of my data table </h3> <p>You can revert to the a plain old spreadsheet by selecting any cell within your table, then looking for the “Table” tab at the top of your screen. Choose the option that says “Convert to Range”.</p> <h3 id="show-me-a-video"> <a href="#show-me-a-video" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Show me a video </h3> <p>This video goes through many of the details of sorting and filtering:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/QByd8L7owsQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" style="margin: 2em;"></iframe> </div> </div> </div> </div> </body> </html>

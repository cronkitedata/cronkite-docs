<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Scraping part 1 - Data reporting @ Cronkite</title> <link rel="shortcut icon" href="http://localhost:4000/cronkite-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/cronkite-docs/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/cronkite-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/cronkite-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>Scraping part 1 | Data reporting @ Cronkite</title> <meta name="generator" content="Jekyll v3.7.4" /> <meta property="og:title" content="Scraping part 1" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism" /> <meta property="og:description" content="A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism" /> <link rel="canonical" href="http://localhost:4000/cronkite-docs/special/scrape-part1.html" /> <meta property="og:url" content="http://localhost:4000/cronkite-docs/special/scrape-part1.html" /> <meta property="og:site_name" content="Data reporting @ Cronkite" /> <script type="application/ld+json"> {"url":"http://localhost:4000/cronkite-docs/special/scrape-part1.html","description":"A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism","headline":"Scraping part 1","@type":"WebPage","@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/cronkite-docs" class="site-title lh-tight">Data reporting @ Cronkite</a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/cronkite-docs/" class="navigation-list-link">Home</a></li><li class="navigation-list-item"><a href="http://localhost:4000/cronkite-docs/general" class="navigation-list-link">General topics</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/general/01-resources.html" class="navigation-list-link">Resources</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/general/02-sourcing.html" class="navigation-list-link">Data sources and sourcing</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/general/03-newsroom-math.html" class="navigation-list-link">Newsroom math</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/general/04-data-diary.html" class="navigation-list-link">Replication and the data diary</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/general/05-file-formats.html" class="navigation-list-link">File formats</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/general/06-programming-concepts.html" class="navigation-list-link">Intro to coding</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/cronkite-docs/excel" class="navigation-list-link">Excel</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/excel/xlguides" class="navigation-list-link">Excel guides</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-refresher.html" class="navigation-list-link">Excel refresher</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-formulas.html" class="navigation-list-link">Excel formulas</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-tidydata.html" class="navigation-list-link">Data types / tidy data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-filtersort.html" class="navigation-list-link">Filter and sort</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/xlguides/xl-pivot.html" class="navigation-list-link">Grouping with pivot tables</a> </li></ul></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/excel/xlpractice" class="navigation-list-link">Excel practice</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/practice/01-excel-azpop-exercise.html" class="navigation-list-link">Change and percent in Arizona population data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/practice/03-excel-rates.html" class="navigation-list-link">Rates and ratios with FBI data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/practice/05-excel-police-uof.html" class="navigation-list-link">Build your own use of force database</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/practice/07-excel-kpop.html" class="navigation-list-link">Formulas for boring Spotify playlists</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/practice/08-excel-pop-filter-sort.html" class="navigation-list-link">Population data filter & sort</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/practice/11-excel-pivot-pools.html" class="navigation-list-link">Practice with swimming pool inspections</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/cronkite-docs/excel/practice/12-excel-baseball.html" class="navigation-list-link">Pivot tables with baseball scores</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/cronkite-docs/r-stats" class="navigation-list-link">R for journalism</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/r-stats/r-intro.html" class="navigation-list-link">Starting R</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/r-stats/r-test-embed.html" class="navigation-list-link">Starting R</a></li></ul></li><li class="navigation-list-item active"><a href="http://localhost:4000/cronkite-docs/special" class="navigation-list-link">Special</a><ul class="navigation-list-child-list "><li class="navigation-list-item active"><a href="http://localhost:4000/cronkite-docs/special/scrape-part1.html" class="navigation-list-link active">Scraping part 1</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/special/cleanup_pdf.html" class="navigation-list-link">PDF tools</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/special/cleanup_openrefine.html" class="navigation-list-link">Cleaning data with OpenRefine</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/special/regex-beginning.html" class="navigation-list-link">Intro to Regular Expressions</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/cronkite-docs/records" class="navigation-list-link">Public records</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/foia/foia-help.html" class="navigation-list-link">Getting FOIA help</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/foia/records-stories.html" class="navigation-list-link">FOIA stories</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/foia/public-records-outside-in.html" class="navigation-list-link">Public records strategy</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/foia/arizona-foia.html" class="navigation-list-link">Arizona public records</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/foia/tips.html" class="navigation-list-link">FOIA resources</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/cronkite-docs/workshops" class="navigation-list-link">Workshops</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/workshops/bootcamp.html" class="navigation-list-link">Cronkite bootcamp</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/workshops/cronkite-mayo.html" class="navigation-list-link">Cronkite-Mayo</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/workshops/newstrain/newstrain.html" class="navigation-list-link">NewsTrain Phoenix</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/workshops/writing.html" class="navigation-list-link">NICAR master class</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/workshops/phd-sources.html" class="navigation-list-link">Links to source data for doctoral students</a></li><li class="navigation-list-item "><a href="http://localhost:4000/cronkite-docs/workshops/fundamental1day.html" class="navigation-list-link">1-day CAR workshop</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Data reporting @ Cronkite" aria-label="Search Data reporting @ Cronkite" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="https://isearch.asu.edu/profile/3189494">Sarah Cohen / Knight Chair / Cronkite School</a></li> </ul> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/cronkite-docs/special">Special</a></li> <li class="breadcrumb-nav-list-item"><span>Scraping part 1</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 class="no_toc" id="web-scraping---part-1"> <a href="#web-scraping---part-1" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Web scraping - Part 1 </h1> <p>Scraping data has two meanings in journalism. In one sense, it means extracting information from just one source, like a web page or a PDF document. In another sense, it means pulling data from multiple pages, like individual profiles of people. A typical workflow for might be:</p> <ol> <li>Find a list or a way to guess at a list for all of the pages you might want</li> <li>Write a program to “crawl” a website to save those pages.</li> <li>Extract the information from each page into a database.</li> </ol> <p>Sometimes, though, it’s not even necessary to go that far.</p> <p>Looking for data on the web can be as simple as good searching. You might find what Rob Gebeloff calls an “JSON miracle”. Or you might be able to just change a few words in a window to get just what you want.</p> <ol id="markdown-toc"> <li><a href="#understanding-requests" id="markdown-toc-understanding-requests">Understanding requests</a> <ol> <li><a href="#get-vs-post" id="markdown-toc-get-vs-post">GET vs. POST</a></li> </ol> </li> <li><a href="#looking-under-the-hood" id="markdown-toc-looking-under-the-hood">Looking under the hood</a> <ol> <li><a href="#using-the-chrome-developer-tab-inspector" id="markdown-toc-using-the-chrome-developer-tab-inspector">Using the Chrome Developer Tab (Inspector)</a> <ol> <li><a href="#an-important-note" id="markdown-toc-an-important-note">An important note</a></li> </ol> </li> <li><a href="#using-information-under-the-hood" id="markdown-toc-using-information-under-the-hood">Using information under the hood</a></li> <li><a href="#overriding-page-limits" id="markdown-toc-overriding-page-limits">Overriding page limits</a></li> </ol> </li> <li><a href="#the-json-miracle" id="markdown-toc-the-json-miracle">The json miracle</a> <ol> <li><a href="#a-bigger-json-miracle" id="markdown-toc-a-bigger-json-miracle">A bigger JSON miracle</a></li> </ol> </li> <li><a href="#scraping-with-xpath" id="markdown-toc-scraping-with-xpath">Scraping with XPATH</a> <ol> <li><a href="#document-object-models-and-xpath" id="markdown-toc-document-object-models-and-xpath">Document object models and XPATH</a></li> <li><a href="#a-simple-scrape-texas-death-row" id="markdown-toc-a-simple-scrape-texas-death-row">A simple scrape: Texas Death Row</a></li> <li><a href="#on--your-own" id="markdown-toc-on--your-own">On your own</a></li> </ol> </li> </ol> <h2 id="understanding-requests"> <a href="#understanding-requests" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Understanding requests </h2> <p>When you use the search box WITHIN a website, you are usually searching an internal database that hasn’t been indexed by Google.</p> <p>Take a simple example. Go to the ASU website, and look for <a href="https://isearch.asu.edu/asu-people/">the directory of faculty and staff</a>. On the search page, type “Cronkite” into the search box. Look at what happened to the back end of the link address, or URL:</p> <p><img src="/cronkite-docs/assets/images/31-urlchasing.png" alt="" /></p> <p>When you see</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      xx=something&amp;yy=somethingelse
</code></pre></div></div> <p>you know that there is a query going on inside the site. Depending on which product is being used to build the site, it might have a question mark before the data.</p> <p>If you search the same site for my name, you should get this URL: <a href="https://isearch.asu.edu/profile/3189494">https://isearch.asu.edu/profile/3189494</a>. Notice that there is a number at the end This is common: most database programs create unique identifiers for each record, just the way we did in the Excel exercises. That suggests there might be someone with the number 3189495! Indeed, there is:</p> <p><img src="/cronkite-docs/assets/images/31-urlchasing2.png" alt="" /></p> <h3 id="get-vs-post"> <a href="#get-vs-post" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> GET vs. POST </h3> <p>So far, the requests you’ve seen are all GET requests, meaning that the search criteria are built into the URL. There is also something called POST requests, which are usually more complicated and usually can’t be done just by typing into the browser. We’ll get to those later.</p> <h2 id="looking-under-the-hood"> <a href="#looking-under-the-hood" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Looking under the hood </h2> <h3 id="using-the-chrome-developer-tab-inspector"> <a href="#using-the-chrome-developer-tab-inspector" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Using the Chrome Developer Tab (Inspector) </h3> <p>Browsers like Chrome and Safari have built in tools that are designed for developers to test their sites, but can also be used to inspect what is happening on a published site.</p> <p><a href="/cronkite-docs/assets/docs/simple-page.html">This is an extremely simple web page</a> that has several characteristics:</p> <ul> <li>In the header, it has several scripts and references to outside resources. Don’t worry about that right now.</li> <li>It has a defined style for a paragraph, called p.intro, which will be used later. A style is a way to format web pages using CSS, which you may have learned in high school or in a basic computing class in college.</li> <li>I has a heading, two paragraphs and a &lt;div&gt; element that contains a table.</li> <li>The table is created using a script from a json file held in the same directory.</li> </ul> <p>Right-click anywhere on the page and choose “Inspect”. It will open to a different part of the page depending on where you click. Expand and collapse the little arrows to show and hide the elements.</p> <p><img src="/cronkite-docs/assets/images/31-simple-page2.png" alt="" /></p> <p>Only the “body” tag is opened in this image, but you can see the structure of the page and the tags, id, class and other details of each element. At the bottom, the Inspector tells you the route you’d take to find to the currently selected element on the page. In this case it means, “beginning at the top, go to the &lt;body&gt; tag, then look for a &lt;p&gt; tag that has a class of <em>intro</em>”</p> <p>Getting used to looking at pages like this helps you understand what is in a web page, but also lets you see things that aren’t displayed on your screen.</p> <h4 id="an-important-note"> <a href="#an-important-note" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> An important note </h4> <p>Sometimes you’ll see “Responsive” at the top of the screen when you go into the Inspector. This means that Chrome is testing sites for mobile-friendly responsiveness. If you were building a website, that would be good. But because you’re trying to extract information from a website, it’s bad. Make sure to turn that off by clicking on the image of a phone in your inspector:</p> <p><img src="/cronkite-docs/assets/images/31-turn-off-phone.png" alt="" /></p> <h3 id="using-information-under-the-hood"> <a href="#using-information-under-the-hood" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Using information under the hood </h3> <p>Consider this March 25, 2015 post on Buzzfeed: <a href="http://www.buzzfeed.com/kelleydunlap/rihanna-reveals-new-music-arriving-tomorrow#.cw2x8QWpx">“Listen to Rihanna’s New Single”</a> describes how Buzzfeed looked behind Rihanna’s website and found a link to a new song that was top secret in the industry and wouldn’t be released for another day.</p> <p><img src="/cronkite-docs/assets/images/31-bbhm.webp" alt="" /></p> <p>This is what happened: The author, trolling through the web page, found a link that contained the phrase “APPROVED-3.256” Copying and pasting that link into a browser showed the promo for her hit single.</p> <p>Griff Palmer, then of The New York Times, helped Declan Walsh prove that the <a href="https://www.nytimes.com/2015/05/18/world/asia/fake-diplomas-real-cash-pakistani-company-axact-reaps-millions-columbiana-barkley.html">same company was behind a ring of fake universities</a>, identified by <a href="https://www.nytimes.com/2015/05/17/world/asia/tracking-axacts-websites.html">working backwards</a> to find links to the same images, accreditation bodies and similar telltale signs. He eventually found more than 350 schools with signs of similarities.</p> <p>Getting used to reading underneath the slick presentation can reap stories and scoops.</p> <h3 id="overriding-page-limits"> <a href="#overriding-page-limits" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Overriding page limits </h3> <p>Some websites can be tricked into giving you more at once than you think. One example is the <a href="https://www.mcso.org/Mugshot">Maricopa County Sheriff’s public mugshot site</a>, which gives you information on the people who are in the county jail every day.</p> <p><img src="/cronkite-docs/assets/images/31-mugshots1.png" alt="" /></p> <p>Hover over the box with the “10” in it, and right-click to get the developers’ window by choosing “Inspect”. In your inspector, change one of the options you see from 100 to 1000. (Make sure to change the value=”100” part inside the option tag. That’s the part that the program will pay attention to – the other one is just what you see on the screen.)</p> <p><img src="/cronkite-docs/assets/images/31-mugshots2.png" alt="" /></p> <p>When you select it, you should be seeing all of the mugshots for that day.</p> <p>This doesn’t always work, depending on how the website was created. Sometimes looking at the page source shows more than in the document model, and sometimes all of the data isn’t loaded at the beginning.</p> <p>One hint is that if you click on “Next page” and there is no hesitation before it shows you the rest of the records, there is probably a dataset sitting on your browser. If it takes a second, it is probably going back to the original server to get more.</p> <h2 id="the-json-miracle"> <a href="#the-json-miracle" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> The json miracle </h2> <p>This time, you’ll look at the network resources tab of our simple web page.</p> <ul> <li>Open the inspector</li> <li><a href="/cronkite-docs/assets/docs/simple-page.html">Load the page</a> (or refresh it if you didn’t have the Inspector open already)</li> <li>And select the Network tab. (You may have to look for little » arrows to find it.)</li> </ul> <p><img src="/cronkite-docs/assets/images/31-simple-page3.png" alt="" /></p> <p>This lists all of the resources that are accessed over a network to build your page. It includes items referenced in the head, and items loaded by scripts elsewhere in the page. Here you can see that it references the original page’s HTML; bootstrap and JQuery resources; and something at the end called simple.json, which is initiated by the JQuery.</p> <p><img src="/cronkite-docs/assets/images/31-simple-page4.png" alt="" /></p> <p>Click on the json file, and take a look at what you see. (You may have to expand the little triangles to get to this):</p> <p><img src="/cronkite-docs/assets/images/31-simple-page5.png" alt="" /></p> <p>What you have is a json miracle! If you <a href="/cronkite-docs/general/file-formats">reviewed the tutorial on file types</a>, this is one of the best-of-all-worlds scenarios.</p> <p>This is a little database that can be converted to a .csv or can be read into R without having to scrape anything! Most websites that use JQuery or similar libraries have a json dataset somewhere buried in them.</p> <p>Try right-clicking on the json object on the left side, and choose “Copy” -&gt; “As response”. Now go to a json-to-csv converter (<a href="http://www.convertcsv.com/json-to-csv.htm">I use this one</a>) and paste into the box. Now you have a csv or Excel file ready to download, with a preview of what it looks like:</p> <p><img src="/cronkite-docs/assets/images/31-simple-page6.png" alt="" /></p> <h3 id="a-bigger-json-miracle"> <a href="#a-bigger-json-miracle" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> A bigger JSON miracle </h3> <p>Open your Inspector panel, and go to this <a href="http://mlb.mlb.com/stats/sortable.jsp#elem=%5Bobject+Object%5D&amp;tab_level=child&amp;click_text=Sortable+Player+hitting&amp;game_type='R'&amp;season=2018&amp;season_type=ANY&amp;league_code='MLB'&amp;sectionType=sp&amp;statType=hitting&amp;page=1&amp;ts=1552429749141&amp;timeframe=&amp;playerType=ALL&amp;last_x_days=&amp;split=h">list of Major League Baseball player statistics</a></p> <p>(Once again, be sure your “Responsive” setting is off by clicking on the little phone in Inspector. Otherwise you’ll be sent to the mobile site, which is different.)</p> <p>You’re interested in getting to the data shown on the left side of the screen, but you don’t want to have to page 21 times to get it.</p> <p><img src="/cronkite-docs/assets/images/31-mlb1.png" alt="" /></p> <p>In your network tab, somewhere down the side is a file that begins with “stats.splayer?season=….” These are often hard to find, but that is where the JSON file that we looked at earlier resides on this page. (Often, you’ll look for something that has “ajax”, “jsaon”, “xml”, or “xthr” in the name. Other times, just scroll through and look for requests or responses that look like data.)</p> <p>You should see a ver long “Request URL” on the right. If you scroll all the way down, you’ll see that request has been split up into its pieces, which we can see under “Query String Parameters”</p> <p><img src="/cronkite-docs/assets/images/31-mlb2.png" alt="" /></p> <p>Here, we can see what characteristics we need to change to get more of the data at once.</p> <p>Go back up top, and copy and paste the “Request URL” into a new browser window. This will bring a new page with the first 50 rows of the table. Just go back into the browser’s address, and change the 50 at the end of the URL to 1000:</p> <p><img src="/cronkite-docs/assets/images/31-mlb3.png" alt="" /></p> <p>It will take a little longer to load, but now you’ll have a JSON file with the first 1000 rows (you can see that there were a total of 1033 if you study the first few rows of information. You could change both the total number of records and the records to page to a higher number if you wanted, to get them all.)</p> <p>Copy and paste the new address into your nifty json to csv converter, and you’ll get a downloadable table ready for analysis.</p> <h2 id="scraping-with-xpath"> <a href="#scraping-with-xpath" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Scraping with XPATH </h2> <p>There may be no JSON or XML miracle waiting for you. Instead, you might have to convert the HTML inside a page into a spreadsheet or database file.</p> <p>Samantha Sunne <a href="https://docs.google.com/presentation/d/e/2PACX-1vTBBph8FTWX4A09C22oWMxZuiLm_hkcprIjPfRfusBDlPIyvSEJWERH1YHyjQZI29FcseD9aP1cYlrk/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g1199aeb248_0_120">has a terrific tutorial showing you how to do this in Google Sheets</a>. (It’s one of the rare things that Google Sheets can do that is missing in Excel.)</p> <h3 id="document-object-models-and-xpath"> <a href="#document-object-models-and-xpath" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Document object models and XPATH </h3> <p>Think of a web page as a tree - there are two big trunks (the head and the body), then there are little branches that are all from the same trunk. The document object model - or DOM - defines that structure using tags, attributes and element names.</p> <p>Go back to our <a href="/assets/docs/simple-page.html">simple web page</a>, and open the Chrome developer tool using by right-clicking anywhere on the page and choosing “Inspect”. The current element – the one that you have selected – is shown as a path up that tree. In this case, selected paragraph the third level down:</p> <p><img src="/cronkite-docs/assets/images/31-simple-page2.png" alt="" /></p> <p>XPATH is a language that lets you select any of these tags. It starts from the top and moves down until it finds what you’re looking for. In this case, the first &lt;p&gt; tag on the page would simply be referenced this way:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       body/p (starting from the top ahdn)
         or
       //p  (the first p it finds anywhere)
</code></pre></div></div> <p>Using the Chrome browser, install <a href="https://chrome.google.com/webstore/detail/scraper/mbigbapnjcgaffohmbkdlecaccepngjd?hl=en">an extension called Scraper</a>. This is the one you want:</p> <p><img src="/cronkite-docs/assets/images/31-scraper.png" alt="" /></p> <p>XPATH can get quite complicated because it’s so powerful. For example, say you don’t know which paragraph you’re looking for but you know it’s just after the second H1 heading. Your XPATH command then might be:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  /h1[2]/p
</code></pre></div></div> <h3 id="a-simple-scrape-texas-death-row"> <a href="#a-simple-scrape-texas-death-row" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> A simple scrape: Texas Death Row </h3> <p>The list of inmates on <a href="https://www.tdcj.state.tx.us/death_row/dr_offenders_on_dr.html">Texas’s Death Row</a> is a very simple list that is easy to scrape.</p> <p>Select some cells in the table, and before you do anything else, look at your inspector. Look at the bottom of the screen, and it will show you the route that had to be taken to get to your selection. it starts with the html tag, goes to body, then a bunch of other tags, and eventually to a “tr” tag.</p> <p>Now go back to the table, make sure you have a few rows roughly selected, right-click and choose “Scrape similar”</p> <p><img src="/cronkite-docs/assets/images/31-scrape-similar.png" alt="" /></p> <p>That should bring up a list that looks pretty good – it has the id number, the name, dob, etc. in nice columns and rows, and an invitation to copy to your clipboard or export to google docs. (If you get nothing, check to see if the kind of scrape is XPATH rather than JQuery. If it isn’t close down Chrome and try again. I don’t know how to fix that when it happens.)</p> <p>Here are the details when it works:</p> <p><img src="/cronkite-docs/assets/images/31-scrape-window.png" alt="" /></p> <p>Because this page is so simple, all that the scraper had to do was look for any TR tag (//tr), then it is asking for all of the TD tags below that. In other words, there were no other tables in the page that would confuse it. What if there were? You can use other items in the page to steer XPATH to the right place. For instance, this one could have been:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    //div[@class="overflow"]/table/tbody/tr[td]

       or

    //table[1]/tbody/tr[td]
</code></pre></div></div> <p>There is one mistake in this table. That is, the Link only shows the words “Offender Information”. We want the actual link. The reason is XPATH always assumes you want the text shown on the screen, not the underlying information, if you don’t say you want it. Try going into the Link area on left, and make this change:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   *[2]

   to


   *[2]/a/@href
</code></pre></div></div> <p>This means that we are looking for the link (an &lt;a href=…&gt; tag) below the table cells. The “a” refers to the tag itself (a link) and the @href refers to an attribute of that tag, or its URL. Anything that is a tag is just shown as is. Anything that’s referenced INSIDE the tag is an attribute, and it’s preceded by an @ symbol.</p> <h3 id="on--your-own"> <a href="#on--your-own" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> On your own </h3> <p>Try scraping Craigslist for your town using the Chrome Scraper. Look at the elements in the Inspector to see what kind of hidden information you can extract. Here’s what I came up with for a list of items that could easily be extracted from a Craigslist listing using the thumbnail view:</p> <p><img src="/cronkite-docs/assets/images/31-craigslist-scrape.png" alt="" /></p> </div> </div> </div> </div> </body> </html>

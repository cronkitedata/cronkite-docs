<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Pivot tables with baseball scores - Data reporting @ Cronkite</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.5.0 --> <title>Pivot tables with baseball scores | Data reporting @ Cronkite</title> <meta name="generator" content="Jekyll v3.7.4" /> <meta property="og:title" content="Pivot tables with baseball scores" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism" /> <meta property="og:description" content="A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism" /> <link rel="canonical" href="http://localhost:4000/excel/practice/12-excel-baseball.html" /> <meta property="og:url" content="http://localhost:4000/excel/practice/12-excel-baseball.html" /> <meta property="og:site_name" content="Data reporting @ Cronkite" /> <script type="application/ld+json"> {"url":"http://localhost:4000/excel/practice/12-excel-baseball.html","headline":"Pivot tables with baseball scores","description":"A collection of materials used in the data reporting class at ASU’s Cronkite School of Journalism","@type":"WebPage","@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight">Data reporting @ Cronkite</a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/" class="navigation-list-link">Home</a></li><li class="navigation-list-item"><a href="http://localhost:4000/general" class="navigation-list-link">General topics</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/general/01-resources.html" class="navigation-list-link">Resources</a></li><li class="navigation-list-item "><a href="http://localhost:4000/general/02-sourcing.html" class="navigation-list-link">Data sources and sourcing</a></li><li class="navigation-list-item "><a href="http://localhost:4000/general/03-newsroom-math.html" class="navigation-list-link">Newsroom math</a></li><li class="navigation-list-item "><a href="http://localhost:4000/general/05-file-formats.html" class="navigation-list-link">File formats</a></li><li class="navigation-list-item "><a href="http://localhost:4000/general/06-programming-concepts.html" class="navigation-list-link">Intro to coding</a></li></ul></li><li class="navigation-list-item active"><a href="http://localhost:4000/excel" class="navigation-list-link">Excel</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/excel/xlguides" class="navigation-list-link">Excel guides</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-refresher.html" class="navigation-list-link">Excel refresher</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-formulas.html" class="navigation-list-link">Excel formulas</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-tidydata.html" class="navigation-list-link">Data types / tidy data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-filtersort.html" class="navigation-list-link">Filter and sort</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/xlguides/xl-pivot.html" class="navigation-list-link">Grouping with pivot tables</a> </li></ul></li><li class="navigation-list-item active"><a href="http://localhost:4000/excel/xlpractice" class="navigation-list-link">Excel practice</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/01-excel-azpop-exercise.html" class="navigation-list-link">Change and percent in Arizona population data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/03-excel-rates.html" class="navigation-list-link">Rates and ratios with FBI data</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/05-excel-police-uof.html" class="navigation-list-link">Build your own use of force database</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/07-excel-kpop.html" class="navigation-list-link">Formulas for boring Spotify playlists</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/08-excel-pop-filter-sort.html" class="navigation-list-link">Population data filter & sort</a> </li><li class="navigation-list-item "> <a href="http://localhost:4000/excel/practice/11-excel-pivot-pools.html" class="navigation-list-link">Practice with swimming pool inspections</a> </li><li class="navigation-list-item active"> <a href="http://localhost:4000/excel/practice/12-excel-baseball.html" class="navigation-list-link active">Pivot tables with baseball scores</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/r-stats" class="navigation-list-link">R for journalism</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/r-stats/r-intro.html" class="navigation-list-link">Starting R</a></li><li class="navigation-list-item "><a href="http://localhost:4000/r-stats/r-test-embed.html" class="navigation-list-link">Starting R</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/special" class="navigation-list-link">Special</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/special/scrape-part1.html" class="navigation-list-link">Scraping part 1</a></li><li class="navigation-list-item "><a href="http://localhost:4000/special/cleanup_pdf.html" class="navigation-list-link">PDF tools</a></li><li class="navigation-list-item "><a href="http://localhost:4000/special/cleanup_openrefine.html" class="navigation-list-link">Cleaning data with OpenRefine</a></li><li class="navigation-list-item "><a href="http://localhost:4000/special/regex-beginning.html" class="navigation-list-link">Intro to Regular Expressions</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/records" class="navigation-list-link">Public records</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/foia/foia-help.html" class="navigation-list-link">Getting FOIA help</a></li><li class="navigation-list-item "><a href="http://localhost:4000/foia/records-stories.html" class="navigation-list-link">FOIA stories</a></li><li class="navigation-list-item "><a href="http://localhost:4000/foia/public-records-outside-in.html" class="navigation-list-link">Public records strategy</a></li><li class="navigation-list-item "><a href="http://localhost:4000/foia/arizona-foia.html" class="navigation-list-link">Arizona public records</a></li><li class="navigation-list-item "><a href="http://localhost:4000/foia/tips.html" class="navigation-list-link">FOIA resources</a></li></ul></li><li class="navigation-list-item"><a href="http://localhost:4000/workshops" class="navigation-list-link">Workshops</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/workshops/bootcamp.html" class="navigation-list-link">Cronkite bootcamp</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/cronkite-mayo.html" class="navigation-list-link">Cronkite-Mayo</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/newstrain/newstrain.html" class="navigation-list-link">NewsTrain Phoenix</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/writing.html" class="navigation-list-link">NICAR master class</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/phd-sources.html" class="navigation-list-link">Links to source data for doctoral students</a></li><li class="navigation-list-item "><a href="http://localhost:4000/workshops/fundamental1day.html" class="navigation-list-link">1-day CAR workshop</a></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Data reporting @ Cronkite" aria-label="Search Data reporting @ Cronkite" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="https://isearch.asu.edu/profile/3189494">Sarah Cohen / Knight Chair / Cronkite School</a></li> </ul> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/excel">Excel</a></li> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/excel/xlpractice">Excel practice</a></li> <li class="breadcrumb-nav-list-item"><span>Pivot tables with baseball scores</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 class="no_toc" id="pivot-tables-how-many-how-much"> <a href="#pivot-tables-how-many-how-much" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Pivot tables: How many? How much? </h1> <ol id="markdown-toc"> <li><a href="#files-for-this-tutorial" id="markdown-toc-files-for-this-tutorial">Files for this tutorial:</a></li> <li><a href="#grouping" id="markdown-toc-grouping">Grouping</a> <ol> <li><a href="#counting-baseball-games" id="markdown-toc-counting-baseball-games">Counting baseball games</a></li> <li><a href="#summarize-your-data" id="markdown-toc-summarize-your-data">Summarize your data</a></li> <li><a href="#different-kinds-of-summaries" id="markdown-toc-different-kinds-of-summaries">Different kinds of summaries</a></li> <li><a href="#automatic-percentages" id="markdown-toc-automatic-percentages">Automatic percentages</a></li> </ol> </li> <li><a href="#more-complicated-pivot-tables" id="markdown-toc-more-complicated-pivot-tables">More complicated pivot tables</a></li> <li><a href="#crosstabs" id="markdown-toc-crosstabs">Crosstabs</a></li> <li><a href="#on-your-own" id="markdown-toc-on-your-own">On your own</a></li> </ol> <p>A pivot table is a powerful way to summarize data in Excel. It’s designed to answer questions that start with the words, “how many?” or “how much?”.</p> <p>Before you start, <a href="https://github.com/datajtext/DataJournalismTextbook/blob/master/Modules/GroupBy/group_by_with_excel.md">review the tutorial written by Matt Waite</a> ) of the University of Nebraska to get a basic understanding of summarizing data using pivot tables.</p> <p>Download the .csv file for that tutorial by <a href="https://github.com/datajtext/DataJournalismTextbook/blob/master/Data/mountainlions.csv">right-clicking on this link</a> and choosing “Save Link as…” (in Chrome) or “Download Linked File As..” (in Safari)</p> <h2 id="files-for-this-tutorial"> <a href="#files-for-this-tutorial" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Files for this tutorial: </h2> <p><strong><a href="/assets/data/xlexamples/diamondbacks.xlsx">Arizona Diamondback scores for 2018</a></strong></p> <p>This file has four pages:</p> <ul> <li><em>games</em>: The main data page showing the results the Arizona Diamondbacks’ 2018 season, including the win-loss record, scores, attendance and other details. This data is formatted as a data table, and follows tidy data principles.</li> <li><em>team_names</em>: A translation of the abbreviated team names, to be used in a different exercise.</li> <li><em>source</em>: The source of the data with a glossary of terms</li> <li><em>diary</em>: Changes made to the original to prepare for this exercise</li> </ul> <p><img src="/assets/images/07-xlpivot-diamondbacks1.png" alt="main table" /></p> <h2 id="grouping"> <a href="#grouping" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Grouping </h2> <p>Every data analysis program can do some form of “grouping”. Many reporters confuse “sorting” with “grouping” because that’s how we express it in plain language. But in Excel, sorting and grouping are very different things. <em>Sorting</em> involves arranging a table’s rows into some order based on the values in a column. In other languages, this is called <em>arranging</em> or <em>ordering</em>, much clearer concepts. <em>Grouping</em>, on the other hand, means to summarize – count, sum, or average, for example – using the value of a discrete categorical value. Examples include:</p> <ul> <li>The number of crimes each month</li> <li>The total value of campaign contributions in each state</li> <li>The average height of men vs. women in your class</li> </ul> <p>The simple pivot table tutorial shown above displays the number of mountain lion sightings in each Nebraska county:</p> <p><img src="/assets/images/07-xlpivot-mountainlions.png" alt="mountain lions" /></p> <h3 id="counting-baseball-games"> <a href="#counting-baseball-games" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Counting baseball games </h3> <p>Suppose you want to know <em>how many</em> games the Diamondbacks won, and <em>how many</em> they lost in the 2018 season. You could filter the original table, note the number of items shown, and then filter the opposite way. But then you’d have to repeat that every time you wanted to check your answers. Instead, it would be much better if we just had this table:</p> <div class="table-wrapper"><table> <tbody> <tr> <td>Win</td> <td>80</td> </tr> <tr> <td>Lose</td> <td>82</td> </tr> <tr> <td>Total</td> <td>162</td> </tr> </tbody> </table></div> <p>That’s exactly what a pivot table does.</p> <h3 id="summarize-your-data"> <a href="#summarize-your-data" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Summarize your data </h3> <p>There are several ways to get a new pivot table:</p> <p><img src="/assets/images/07-xlpivot-diamondbacks2.png" alt="summarize" style="float:right;width:50%;padding: 20px 20px 20px 20px;" /></p> <ul> <li>If your data is formatted as a table, as the Diamondbacks worksheet is, you can select the “Summarize with a Pivot Table” button under the Table tab.</li> <li>Select any single cell in your table, and choose Insert, then Pivot Table.</li> <li>Use the menu (not the ribbon), under Data, Summarize with Pivot Table. ßß</li> </ul> <p style="clear:both"></p> <p><img src="/assets/images/07-xlpivot-diamondbacks3.png" alt="where to put it" style="width:55%; float:left;padding: 10px 20px 20px 20px;" /></p> <p>Excel will guess what data you want to summarize – check to make sure it’s right (in our case, Table 2), and then select where to put the table. You’ll usually leave it on the default, which is to make a new page in your workbook.</p> <p style="clear:both"></p> <p>Now you can pour your data into the empty shell.</p> <p class="m-3"><img src="/assets/images/07-xlpivot-diamondbacks4.png" alt="empty pivot table" /></p> <p>Drag the fields you want from the list into the empty boxes. Anything you put in the “Rows” section will be shown in rows, down the left side of the table. These will usually be categories, names or dates.</p> <p>The most confusing part of this box is the “Values” area. This is the number that will be shown in the middle of the table – the one you want to compute. If you choose a field that contains words, Excel will guess that you want to count (Count) them up, answering the question, “How many?”. If you choose a field that contains numbers, it will assume you want to add them up (Sum), answering the question, “How much?”.</p> <p class="m-3"><img src="/assets/images/07-xlpivot1.gif" alt="short gif" /></p> <h3 id="different-kinds-of-summaries"> <a href="#different-kinds-of-summaries" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Different kinds of summaries </h3> <p>You can compute more than one number. For example, this table shows you that almost 5 million tickets were sold over the season, averaging 29,760 per game. And that they averaged higher attendance when they lost than when they won.</p> <p><img src="/assets/images/07-xlpivot-diamondbacks9.png" alt="empty pivot table" /></p> <h3 id="automatic-percentages"> <a href="#automatic-percentages" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Automatic percentages </h3> <p>Automatic percentages are computed using the same box, but in a slightly different form. Drag the number field into the Values area again, but this time click on “Show Data As…”, and, in this case, choose “Percent of Column Total”:</p> <p><img src="/assets/images/07-xlpivot2.gif" alt="% of column" /> {: .m-3})</p> <h2 id="more-complicated-pivot-tables"> <a href="#more-complicated-pivot-tables" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> More complicated pivot tables </h2> <p><img src="/assets/images/07-xlpivot-diamondbacks10.png" alt="where to put it" style="width:55%; float:right;padding: 10px 20px 20px 20px;" /></p> <p>You aren’t stuck with using only one field – you can have as many as you can fit on the page. Here’s an example, showing win-loss statistics at home and on the road, at night and during the day.</p> <p style="clear:both;"></p> <h2 id="crosstabs"> <a href="#crosstabs" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Crosstabs </h2> <p>You probably ran into crosstabs when you studied statistics, or in a political science course if you analyzed poll results. The idea of a crosstab is to compare two (or more) variables in two dimensions: columns and rows.</p> <p>At the simplest level, it’s just a count of how many items fall into each category. In this case, let’s look at how many wins and losses the team had playing at home and away. Just drag <strong>at</strong> field into the Column box to get a 2-dimensional table, grouped by both home/away and win/lose.</p> <p><img src="/assets/images/07-xlpivot-diamondbacks5.png" alt="col row" /></p> <p>It happens that the Diamondbacks won just over half of the games they played, which were split equally between games played in Phoenix and games played elsewhere. These numbers look like the team does a little better on the road, but it’s hard to be sure.</p> <p>That’s where percentages - or rates - come into play. We’d like to be able to say whether the team is more or less likely to win at home or on the road, and by how much.</p> <p>These are common kinds of questions in journalism and in life. For example:</p> <ul> <li>Do immigrants get deported at higher rates when they have criminal histories?</li> <li>Are women more likely to get c-sections when they have private health insurance?</li> <li>Are high-income minorities rejected for loans at a higher rate than non-minorities?</li> <li>Are you more likely to score well on an exam in the morning or afternoon?</li> </ul> <p>Translating these questions into pivot tables takes practice and you often have to read your results out loud to yourself.</p> <p>At first, just use Philip Meyer’s rule of thumb:</p> <div style="margin: 20px 20px 20px 20px;background-color:lightgrey;"> Put the category that happens first in time (the <i>independent variable</i>) in the column area, the category that comes later in the row area, and compute the column percentages. </div> <p>In our example, it will look like this when you’re done:</p> <p><img src="/assets/images/07-xlpivot-diamondbacks6.png" alt="outcomes" /></p> <h2 id="on-your-own"> <a href="#on-your-own" class="anchor-heading"><svg class="d-inline-block v-align-middle" viewBox="0 0 16 16" version="1.1" width="18" height="18" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> On your own </h2> <p>Try to think of other statistics or comparisons you’d like to calculate by group in this dataset. For example:</p> <ul> <li>Do the Diamondbacks play better at night or during the day?</li> <li>What is the longest game, in innings, played against each team?</li> <li>What is the win-loss record against each team?</li> </ul> </div> </div> </div> </div> </body> </html>
